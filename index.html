+    1 <!DOCTYPE html>
+    2 <html lang="zh-HK">
+    3 <head>
+    4     <meta charset="UTF-8">
+    5     <meta name="viewport" content="width=device-width, initial-scale=1.0">
+    6     <title>é›»è©±è¼¸å…¥å™¨</title>
+    7     <link rel="preconnect" href="https://fonts.googleapis.com">
+    8     <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
+    9     <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Orbitron:wght@600;900&family=Noto+Sans+HK:wght@400;700;900&display=swap" rel="stylesheet">
+   10     <style>
+   11         :root {
+   12             --bg-primary: #0a0e27;
+   13             --bg-secondary: #141b3d;
+   14             --bg-button: #1e2749;
+   15             --accent-1: #00ff88;
+   16             --accent-2: #00d4ff;
+   17             --text-primary: #e8eaf6;
+   18             --text-secondary: #8892b8;
+   19             --shadow-glow: rgba(0, 255, 136, 0.3);
+   20         }
+   21 
+   22         .dark {
+   23             --bg-primary: #0a0e27;
+   24             --bg-secondary: #141b3d;
+   25             --bg-button: #1e2749;
+   26             --accent-1: #00ff88;
+   27             --accent-2: #00d4ff;
+   28             --text-primary: #e8eaf6;
+   29             --text-secondary: #8892b8;
+   30             --shadow-glow: rgba(0, 255, 136, 0.3);
+   31         }
+   32 
+   33         body:not(.dark) {
+   34             --bg-primary: #f0f4f8;
+   35             --bg-secondary: #ffffff;
+   36             --bg-button: #e8eef5;
+   37             --accent-1: #00c853;
+   38             --accent-2: #0091ea;
+   39             --text-primary: #1a237e;
+   40             --text-secondary: #5c6bc0;
+   41             --shadow-glow: rgba(0, 200, 83, 0.2);
+   42         }
+   43 
+   44         * {
+   45             margin: 0;
+   46             padding: 0;
+   47             box-sizing: border-box;
+   48         }
+   49 
+   50         body {
+   51             font-family: 'JetBrains Mono', monospace;
+   52             background: var(--bg-primary);
+   53             color: var(--text-primary);
+   54             min-height: 100vh;
+   55             display: flex;
+   56             justify-content: center;
+   57             align-items: center;
+   58             padding: 20px;
+   59             background-image:
+   60                 radial-gradient(circle at 20% 30%, rgba(0, 255, 136, 0.05) 0%, transparent 50%),
+   61                 radial-gradient(circle at 80% 70%, rgba(0, 212, 255, 0.05) 0%, transparent 50%);
+   62             transition: background 0.3s ease;
+   63         }
+   64 
+   65         /* ========== TIMER STYLES ========== */
+   66         .timer-container {
+   67             position: fixed;
+   68             top: 20px;
+   69             right: 20px;
+   70             background: var(--bg-secondary);
+   71             padding: 12px 20px;
+   72             border-radius: 16px;
+   73             box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
+   74             z-index: 1000;
+   75             display: none;
+   76             align-items: center;
+   77             gap: 10px;
+   78             border: 1px solid rgba(255, 255, 255, 0.1);
+   79         }
+   80 
+   81         .timer-container.active {
+   82             display: flex;
+   83         }
+   84 
+   85         .timer-icon {
+   86             font-size: 1.2rem;
+   87         }
+   88 
+   89         .timer-display {
+   90             font-family: 'Orbitron', sans-serif;
+   91             font-size: 1.1rem;
+   92             font-weight: 600;
+   93             color: var(--accent-2);
+   94             letter-spacing: 2px;
+   95         }
+   96 
+   97         .timer-container.warning .timer-display {
+   98             color: #ff9800;
+   99             animation: timerPulse 1s infinite;
+  100         }
+  101 
+  102         .timer-container.danger .timer-display {
+  103             color: #ff4444;
+  104             animation: timerPulse 0.5s infinite;
+  105         }
+  106 
+  107         .timer-penalty {
+  108             position: fixed;
+  109             top: 70px;
+  110             right: 20px;
+  111             background: linear-gradient(135deg, #ff4444, #ff1744);
+  112             padding: 10px 18px;
+  113             border-radius: 12px;
+  114             font-family: 'Orbitron', sans-serif;
+  115             font-size: 1rem;
+  116             font-weight: 700;
+  117             color: white;
+  118             z-index: 1001;
+  119             opacity: 0;
+  120             transform: translateY(-20px);
+  121             transition: all 0.3s ease;
+  122             box-shadow: 0 4px 20px rgba(255, 68, 68, 0.5);
+  123         }
+  124 
+  125         .timer-penalty.show {
+  126             opacity: 1;
+  127             transform: translateY(0);
+  128             animation: penaltyShake 0.5s ease;
+  129         }
+  130 
+  131         @keyframes penaltyShake {
+  132             0%, 100% { transform: translateX(0); }
+  133             20% { transform: translateX(-10px); }
+  134             40% { transform: translateX(10px); }
+  135             60% { transform: translateX(-5px); }
+  136             80% { transform: translateX(5px); }
+  137         }
+  138 
+  139         @keyframes timerPulse {
+  140             0%, 100% { opacity: 1; }
+  141             50% { opacity: 0.5; }
+  142         }
+  143 
+  144         /* ========== LEVEL INDICATOR ========== */
+  145         .level-indicator {
+  146             position: fixed;
+  147             top: 20px;
+  148             left: 20px;
+  149             background: var(--bg-secondary);
+  150             padding: 12px 20px;
+  151             border-radius: 16px;
+  152             box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
+  153             z-index: 1000;
+  154             display: none;
+  155             align-items: center;
+  156             gap: 10px;
+  157             border: 1px solid rgba(255, 255, 255, 0.1);
+  158         }
+  159 
+  160         .level-indicator.active {
+  161             display: flex;
+  162         }
+  163 
+  164         .level-text {
+  165             font-family: 'Orbitron', sans-serif;
+  166             font-size: 0.9rem;
+  167             font-weight: 600;
+  168             color: var(--accent-1);
+  169             letter-spacing: 1px;
+  170         }
+  171 
+  172         .level-dots {
+  173             display: flex;
+  174             gap: 6px;
+  175         }
+  176 
+  177         .level-dot {
+  178             width: 10px;
+  179             height: 10px;
+  180             border-radius: 50%;
+  181             background: var(--bg-button);
+  182             border: 2px solid var(--text-secondary);
+  183             transition: all 0.3s ease;
+  184         }
+  185 
+  186         .level-dot.completed {
+  187             background: var(--accent-1);
+  188             border-color: var(--accent-1);
+  189             box-shadow: 0 0 10px var(--shadow-glow);
+  190         }
+  191 
+  192         .level-dot.current {
+  193             border-color: var(--accent-2);
+  194             animation: dotPulse 1.5s infinite;
+  195         }
+  196 
+  197         @keyframes dotPulse {
+  198             0%, 100% { transform: scale(1); }
+  199             50% { transform: scale(1.2); }
+  200         }
+  201 
+  202         /* ========== INTRO FLOW STYLES ========== */
+  203         .intro-flow {
+  204             width: 100%;
+  205             max-width: 600px;
+  206             background: var(--bg-secondary);
+  207             border-radius: 32px;
+  208             padding: 60px 40px;
+  209             box-shadow:
+  210                 0 20px 60px rgba(0, 0, 0, 0.3),
+  211                 inset 0 1px 0 rgba(255, 255, 255, 0.1);
+  212             text-align: center;
+  213             animation: fadeIn 0.6s ease;
+  214         }
+  215 
+  216         @keyframes fadeIn {
+  217             from {
+  218                 opacity: 0;
+  219                 transform: scale(0.95);
+  220             }
+  221             to {
+  222                 opacity: 1;
+  223                 transform: scale(1);
+  224             }
+  225         }
+  226 
+  227         .intro-step {
+  228             display: none;
+  229         }
+  230 
+  231         .intro-step.active {
+  232             display: block;
+  233             animation: slideIn 0.5s ease;
+  234         }
+  235 
+  236         @keyframes slideIn {
+  237             from {
+  238                 opacity: 0;
+  239                 transform: translateY(20px);
+  240             }
+  241             to {
+  242                 opacity: 1;
+  243                 transform: translateY(0);
+  244             }
+  245         }
+  246 
+  247         .intro-title {
+  248             font-family: 'Noto Sans HK', 'Orbitron', sans-serif;
+  249             font-size: 2.5rem;
+  250             font-weight: 900;
+  251             background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
+  252             -webkit-background-clip: text;
+  253             -webkit-text-fill-color: transparent;
+  254             background-clip: text;
+  255             margin-bottom: 30px;
+  256             letter-spacing: 2px;
+  257         }
+  258 
+  259         .intro-quote {
+  260             font-family: 'Noto Sans HK', serif;
+  261             font-size: 1.3rem;
+  262             line-height: 2;
+  263             color: var(--text-primary);
+  264             margin: 40px 0;
+  265             padding: 30px;
+  266             background: var(--bg-primary);
+  267             border-radius: 16px;
+  268             border-left: 4px solid var(--accent-1);
+  269             font-style: italic;
+  270             position: relative;
+  271         }
+  272 
+  273         .intro-quote::before {
+  274             content: '"';
+  275             position: absolute;
+  276             top: 10px;
+  277             left: 10px;
+  278             font-size: 4rem;
+  279             color: var(--accent-1);
+  280             opacity: 0.3;
+  281             font-family: Georgia, serif;
+  282         }
+  283 
+  284         .start-btn {
+  285             padding: 20px 60px;
+  286             background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
+  287             border: none;
+  288             border-radius: 50px;
+  289             font-family: 'Noto Sans HK', 'Orbitron', sans-serif;
+  290             font-size: 1.3rem;
+  291             font-weight: 900;
+  292             color: var(--bg-primary);
+  293             cursor: pointer;
+  294             transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
+  295             box-shadow: 0 10px 30px var(--shadow-glow);
+  296             text-transform: uppercase;
+  297             letter-spacing: 2px;
+  298             -webkit-tap-highlight-color: transparent;
+  299             -webkit-touch-callout: none;
+  300             user-select: none;
+  301             touch-action: manipulation;
+  302         }
+  303 
+  304         .start-btn:hover {
+  305             transform: translateY(-3px);
+  306             box-shadow: 0 15px 40px var(--shadow-glow);
+  307         }
+  308 
+  309         .start-btn:active {
+  310             transform: translateY(-1px);
+  311         }
+  312 
+  313         .next-btn {
+  314             margin-top: 30px;
+  315             padding: 16px 40px;
+  316             background: var(--bg-button);
+  317             border: 2px solid var(--accent-1);
+  318             border-radius: 50px;
+  319             font-family: 'Noto Sans HK', 'JetBrains Mono', monospace;
+  320             font-size: 1.1rem;
+  321             font-weight: 700;
+  322             color: var(--accent-1);
+  323             cursor: pointer;
+  324             transition: all 0.3s ease;
+  325             -webkit-tap-highlight-color: transparent;
+  326             user-select: none;
+  327             touch-action: manipulation;
+  328         }
+  329 
+  330         .next-btn:hover {
+  331             background: var(--accent-1);
+  332             color: var(--bg-primary);
+  333             transform: translateY(-2px);
+  334         }
+  335 
+  336         .next-btn:active {
+  337             transform: translateY(0);
+  338         }
+  339 
+  340         .audio-indicator {
+  341             display: inline-flex;
+  342             align-items: center;
+  343             gap: 10px;
+  344             margin-top: 20px;
+  345             padding: 12px 24px;
+  346             background: rgba(0, 255, 136, 0.1);
+  347             border-radius: 30px;
+  348             color: var(--accent-1);
+  349             font-size: 0.9rem;
+  350             animation: pulse 2s infinite;
+  351         }
+  352 
+  353         @keyframes pulse {
+  354             0%, 100% {
+  355                 opacity: 1;
+  356             }
+  357             50% {
+  358                 opacity: 0.6;
+  359             }
+  360         }
+  361 
+  362         .audio-indicator::before {
+  363             content: 'ðŸ”Š';
+  364             font-size: 1.2rem;
+  365         }
+  366 
+  367         .envelope-message {
+  368             font-family: 'Noto Sans HK', sans-serif;
+  369             font-size: 2rem;
+  370             font-weight: 700;
+  371             color: var(--text-primary);
+  372             margin: 60px 0;
+  373             padding: 40px;
+  374             background: var(--bg-primary);
+  375             border-radius: 20px;
+  376             border: 3px solid var(--accent-1);
+  377             box-shadow: 0 0 30px var(--shadow-glow);
+  378             animation: glow 2s infinite;
+  379         }
+  380 
+  381         @keyframes glow {
+  382             0%, 100% {
+  383                 box-shadow: 0 0 30px var(--shadow-glow);
+  384             }
+  385             50% {
+  386                 box-shadow: 0 0 50px var(--shadow-glow), 0 0 80px var(--shadow-glow);
+  387             }
+  388         }
+  389 
+  390         .envelope-icon {
+  391             font-size: 4rem;
+  392             margin-bottom: 20px;
+  393             display: block;
+  394             animation: bounce 1s infinite;
+  395         }
+  396 
+  397         @keyframes bounce {
+  398             0%, 100% {
+  399                 transform: translateY(0);
+  400             }
+  401             50% {
+  402                 transform: translateY(-10px);
+  403             }
+  404         }
+  405 
+  406         .hidden {
+  407             display: none !important;
+  408         }
+  409 
+  410         /* ========== FINAL SCREEN STYLES ========== */
+  411         .final-screen {
+  412             width: 100%;
+  413             max-width: 600px;
+  414             background: var(--bg-secondary);
+  415             border-radius: 32px;
+  416             padding: 60px 40px;
+  417             box-shadow:
+  418                 0 20px 60px rgba(0, 0, 0, 0.3),
+  419                 inset 0 1px 0 rgba(255, 255, 255, 0.1);
+  420             text-align: center;
+  421             animation: finalReveal 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
+  422         }
+  423 
+  424         @keyframes finalReveal {
+  425             from {
+  426                 opacity: 0;
+  427                 transform: scale(0.8) rotateY(10deg);
+  428             }
+  429             to {
+  430                 opacity: 1;
+  431                 transform: scale(1) rotateY(0);
+  432             }
+  433         }
+  434 
+  435         .final-trophy {
+  436             font-size: 6rem;
+  437             margin-bottom: 20px;
+  438             animation: trophyBounce 1s ease infinite;
+  439         }
+  440 
+  441         @keyframes trophyBounce {
+  442             0%, 100% { transform: translateY(0) rotate(0deg); }
+  443             25% { transform: translateY(-10px) rotate(-5deg); }
+  444             75% { transform: translateY(-10px) rotate(5deg); }
+  445         }
+  446 
+  447         .final-title {
+  448             font-family: 'Orbitron', sans-serif;
+  449             font-size: 2.5rem;
+  450             font-weight: 900;
+  451             background: linear-gradient(135deg, #ffd700, #ff8c00);
+  452             -webkit-background-clip: text;
+  453             -webkit-text-fill-color: transparent;
+  454             background-clip: text;
+  455             margin-bottom: 20px;
+  456         }
+  457 
+  458         .final-time-label {
+  459             font-family: 'Noto Sans HK', sans-serif;
+  460             font-size: 1.2rem;
+  461             color: var(--text-secondary);
+  462             margin-bottom: 10px;
+  463         }
+  464 
+  465         .final-time {
+  466             font-family: 'Orbitron', sans-serif;
+  467             font-size: 3.5rem;
+  468             font-weight: 900;
+  469             color: var(--accent-1);
+  470             text-shadow: 0 0 30px var(--shadow-glow);
+  471             margin-bottom: 30px;
+  472             letter-spacing: 4px;
+  473         }
+  474 
+  475         .final-stats {
+  476             display: flex;
+  477             justify-content: center;
+  478             gap: 30px;
+  479             margin-top: 30px;
+  480             flex-wrap: wrap;
+  481         }
+  482 
+  483         .stat-box {
+  484             background: var(--bg-primary);
+  485             padding: 20px 30px;
+  486             border-radius: 16px;
+  487             text-align: center;
+  488         }
+  489 
+  490         .stat-value {
+  491             font-family: 'Orbitron', sans-serif;
+  492             font-size: 2rem;
+  493             font-weight: 900;
+  494             color: var(--accent-2);
+  495         }
+  496 
+  497         .stat-label {
+  498             font-size: 0.85rem;
+  499             color: var(--text-secondary);
+  500             margin-top: 5px;
+  501         }
+  502 
+  503         /* ========== PHONE CONTAINER STYLES ========== */
+  504         .phone-container {
+  505             width: 100%;
+  506             max-width: 400px;
+  507             background: var(--bg-secondary);
+  508             border-radius: 32px;
+  509             padding: 40px 30px;
+  510             box-shadow:
+  511                 0 20px 60px rgba(0, 0, 0, 0.3),
+  512                 inset 0 1px 0 rgba(255, 255, 255, 0.1);
+  513             position: relative;
+  514             overflow: hidden;
+  515             animation: slideUp 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
+  516         }
+  517 
+  518         @keyframes slideUp {
+  519             from {
+  520                 opacity: 0;
+  521                 transform: translateY(30px);
+  522             }
+  523             to {
+  524                 opacity: 1;
+  525                 transform: translateY(0);
+  526             }
+  527         }
+  528 
+  529         .phone-header {
+  530             text-align: center;
+  531             margin-bottom: 30px;
+  532         }
+  533 
+  534         .phone-title {
+  535             font-family: 'Orbitron', sans-serif;
+  536             font-size: 1.5rem;
+  537             font-weight: 900;
+  538             background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
+  539             -webkit-background-clip: text;
+  540             -webkit-text-fill-color: transparent;
+  541             background-clip: text;
+  542             letter-spacing: 2px;
+  543             margin-bottom: 8px;
+  544         }
+  545 
+  546         .phone-subtitle {
+  547             font-size: 0.75rem;
+  548             color: var(--text-secondary);
+  549             text-transform: uppercase;
+  550             letter-spacing: 1px;
+  551         }
+  552 
+  553         .display {
+  554             background: var(--bg-primary);
+  555             border-radius: 16px;
+  556             padding: 24px;
+  557             margin-bottom: 30px;
+  558             min-height: 80px;
+  559             display: flex;
+  560             align-items: center;
+  561             justify-content: center;
+  562             position: relative;
+  563             overflow: hidden;
+  564             box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3);
+  565         }
+  566 
+  567         .display::before {
+  568             content: '';
+  569             position: absolute;
+  570             top: 0;
+  571             left: -100%;
+  572             width: 100%;
+  573             height: 100%;
+  574             background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
+  575             transition: left 0.5s;
+  576         }
+  577 
+  578         .display.success::before {
+  579             animation: shine 0.8s;
+  580         }
+  581 
+  582         @keyframes shine {
+  583             to {
+  584                 left: 100%;
+  585             }
+  586         }
+  587 
+  588         .display-number {
+  589             font-family: 'JetBrains Mono', monospace;
+  590             font-size: 2rem;
+  591             font-weight: 700;
+  592             letter-spacing: 4px;
+  593             color: var(--text-primary);
+  594             text-shadow: 0 0 20px var(--shadow-glow);
+  595             transition: all 0.3s ease;
+  596         }
+  597 
+  598         .display-number.empty {
+  599             color: var(--text-secondary);
+  600             opacity: 0.5;
+  601             font-size: 1rem;
+  602         }
+  603 
+  604         .keypad {
+  605             display: grid;
+  606             grid-template-columns: repeat(3, 1fr);
+  607             gap: 16px;
+  608             margin-bottom: 20px;
+  609         }
+  610 
+  611         .key {
+  612             aspect-ratio: 1;
+  613             background: var(--bg-button);
+  614             border: none;
+  615             border-radius: 16px;
+  616             font-family: 'JetBrains Mono', monospace;
+  617             font-size: 1.5rem;
+  618             font-weight: 700;
+  619             color: var(--text-primary);
+  620             cursor: pointer;
+  621             transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
+  622             position: relative;
+  623             overflow: hidden;
+  624             box-shadow:
+  625                 0 4px 12px rgba(0, 0, 0, 0.2),
+  626                 inset 0 1px 0 rgba(255, 255, 255, 0.1);
+  627             -webkit-tap-highlight-color: transparent;
+  628             -webkit-touch-callout: none;
+  629             -webkit-user-select: none;
+  630             user-select: none;
+  631             touch-action: manipulation;
+  632             min-height: 60px;
+  633         }
+  634 
+  635         .key::before {
+  636             content: '';
+  637             position: absolute;
+  638             top: 50%;
+  639             left: 50%;
+  640             width: 0;
+  641             height: 0;
+  642             border-radius: 50%;
+  643             background: var(--accent-1);
+  644             opacity: 0.3;
+  645             transform: translate(-50%, -50%);
+  646             transition: width 0.4s, height 0.4s;
+  647             pointer-events: none;
+  648         }
+  649 
+  650         .key:active::before {
+  651             width: 100%;
+  652             height: 100%;
+  653         }
+  654 
+  655         .key:hover {
+  656             transform: scale(1.05);
+  657             box-shadow:
+  658                 0 6px 20px rgba(0, 0, 0, 0.3),
+  659                 0 0 20px var(--shadow-glow),
+  660                 inset 0 1px 0 rgba(255, 255, 255, 0.2);
+  661         }
+  662 
+  663         .key:active {
+  664             transform: scale(0.95);
+  665         }
+  666 
+  667         .key.special {
+  668             background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
+  669             color: var(--bg-primary);
+  670             font-weight: 900;
+  671         }
+  672 
+  673         .actions {
+  674             display: grid;
+  675             grid-template-columns: repeat(2, 1fr);
+  676             gap: 16px;
+  677         }
+  678 
+  679         .action-btn {
+  680             padding: 18px;
+  681             background: var(--bg-button);
+  682             border: none;
+  683             border-radius: 16px;
+  684             font-family: 'JetBrains Mono', monospace;
+  685             font-size: 0.9rem;
+  686             font-weight: 700;
+  687             color: var(--text-primary);
+  688             cursor: pointer;
+  689             transition: all 0.2s;
+  690             text-transform: uppercase;
+  691             letter-spacing: 1px;
+  692             box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
+  693             -webkit-tap-highlight-color: transparent;
+  694             -webkit-touch-callout: none;
+  695             -webkit-user-select: none;
+  696             user-select: none;
+  697             touch-action: manipulation;
+  698         }
+  699 
+  700         .action-btn:hover {
+  701             transform: translateY(-2px);
+  702             box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
+  703         }
+  704 
+  705         .action-btn:active {
+  706             transform: translateY(0);
+  707         }
+  708 
+  709         .action-btn.clear {
+  710             background: linear-gradient(135deg, #ff4081, #ff1744);
+  711             color: white;
+  712         }
+  713 
+  714         .action-btn.call {
+  715             background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
+  716             color: var(--bg-primary);
+  717         }
+  718 
+  719         .status-message {
+  720             text-align: center;
+  721             margin-top: 20px;
+  722             padding: 16px;
+  723             border-radius: 12px;
+  724             font-size: 0.9rem;
+  725             font-weight: 700;
+  726             opacity: 0;
+  727             transform: translateY(-10px);
+  728             transition: all 0.3s;
+  729         }
+  730 
+  731         .status-message.show {
+  732             opacity: 1;
+  733             transform: translateY(0);
+  734         }
+  735 
+  736         .status-message.success {
+  737             background: rgba(0, 255, 136, 0.2);
+  738             color: var(--accent-1);
+  739             border: 2px solid var(--accent-1);
+  740             box-shadow: 0 0 20px var(--shadow-glow);
+  741         }
+  742 
+  743         .status-message.error {
+  744             background: rgba(255, 64, 129, 0.2);
+  745             color: #ff4081;
+  746             border: 2px solid #ff4081;
+  747         }
+  748 
+  749         .success-overlay {
+  750             position: absolute;
+  751             top: 0;
+  752             left: 0;
+  753             width: 100%;
+  754             height: 100%;
+  755             background: radial-gradient(circle, var(--accent-1), var(--accent-2));
+  756             opacity: 0;
+  757             pointer-events: none;
+  758             display: flex;
+  759             align-items: center;
+  760             justify-content: center;
+  761             border-radius: 32px;
+  762             transition: opacity 0.3s;
+  763         }
+  764 
+  765         .success-overlay.show {
+  766             opacity: 0.95;
+  767             pointer-events: auto;
+  768             animation: successPulse 0.6s;
+  769         }
+  770 
+  771         @keyframes successPulse {
+  772             0%, 100% {
+  773                 transform: scale(1);
+  774             }
+  775             50% {
+  776                 transform: scale(1.02);
+  777             }
+  778         }
+  779 
+  780         .success-content {
+  781             text-align: center;
+  782             color: var(--bg-primary);
+  783         }
+  784 
+  785         .success-icon {
+  786             font-size: 4rem;
+  787             margin-bottom: 16px;
+  788             animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
+  789         }
+  790 
+  791         @keyframes bounceIn {
+  792             0% {
+  793                 transform: scale(0);
+  794                 opacity: 0;
+  795             }
+  796             50% {
+  797                 transform: scale(1.2);
+  798             }
+  799             100% {
+  800                 transform: scale(1);
+  801                 opacity: 1;
+  802             }
+  803         }
+  804 
+  805         .success-text {
+  806             font-family: 'Orbitron', sans-serif;
+  807             font-size: 1.5rem;
+  808             font-weight: 900;
+  809             margin-bottom: 8px;
+  810         }
+  811 
+  812         .success-subtext {
+  813             font-size: 0.9rem;
+  814             opacity: 0.9;
+  815         }
+  816 
+  817         /* ========== SEQUENCE GAME STYLES ========== */
+  818         .sequence-container {
+  819             width: 100%;
+  820             max-width: 500px;
+  821             background: var(--bg-secondary);
+  822             border-radius: 32px;
+  823             padding: 40px 30px;
+  824             box-shadow:
+  825                 0 20px 60px rgba(0, 0, 0, 0.3),
+  826                 inset 0 1px 0 rgba(255, 255, 255, 0.1);
+  827             position: relative;
+  828             overflow: hidden;
+  829             animation: slideUp 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
+  830         }
+  831 
+  832         .sequence-header {
+  833             text-align: center;
+  834             margin-bottom: 30px;
+  835         }
+  836 
+  837         .sequence-title {
+  838             font-family: 'Orbitron', sans-serif;
+  839             font-size: 1.5rem;
+  840             font-weight: 900;
+  841             background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
+  842             -webkit-background-clip: text;
+  843             -webkit-text-fill-color: transparent;
+  844             background-clip: text;
+  845             letter-spacing: 2px;
+  846             margin-bottom: 8px;
+  847         }
+  848 
+  849         .sequence-subtitle {
+  850             font-family: 'Noto Sans HK', sans-serif;
+  851             font-size: 0.9rem;
+  852             color: var(--text-secondary);
+  853             letter-spacing: 1px;
+  854         }
+  855 
+  856         .sequence-area {
+  857             background: var(--bg-primary);
+  858             border-radius: 20px;
+  859             padding: 30px 20px;
+  860             margin-bottom: 25px;
+  861             min-height: 120px;
+  862             box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3);
+  863         }
+  864 
+  865         .sequence-slots {
+  866             display: flex;
+  867             justify-content: center;
+  868             gap: 10px;
+  869             flex-wrap: wrap;
+  870         }
+  871 
+  872         .sequence-item {
+  873             width: 55px;
+  874             height: 55px;
+  875             background: linear-gradient(145deg, var(--bg-button), var(--bg-secondary));
+  876             border: 3px solid var(--accent-2);
+  877             border-radius: 14px;
+  878             display: flex;
+  879             align-items: center;
+  880             justify-content: center;
+  881             font-family: 'Orbitron', sans-serif;
+  882             font-size: 1.5rem;
+  883             font-weight: 900;
+  884             color: var(--text-primary);
+  885             cursor: grab;
+  886             transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
+  887             box-shadow:
+  888                 0 4px 15px rgba(0, 0, 0, 0.3),
+  889                 inset 0 1px 0 rgba(255, 255, 255, 0.1);
+  890             user-select: none;
+  891             -webkit-user-select: none;
+  892             touch-action: none;
+  893         }
+  894 
+  895         .sequence-item:hover {
+  896             transform: scale(1.08) translateY(-3px);
+  897             box-shadow:
+  898                 0 8px 25px rgba(0, 0, 0, 0.4),
+  899                 0 0 20px var(--shadow-glow);
+  900             border-color: var(--accent-1);
+  901         }
+  902 
+  903         .sequence-item:active,
+  904         .sequence-item.dragging {
+  905             cursor: grabbing;
+  906             transform: scale(1.12);
+  907             box-shadow:
+  908                 0 12px 35px rgba(0, 0, 0, 0.5),
+  909                 0 0 30px var(--shadow-glow);
+  910             border-color: var(--accent-1);
+  911             z-index: 100;
+  912         }
+  913 
+  914         .sequence-item.drag-over {
+  915             border-color: #ffd700;
+  916             background: linear-gradient(145deg, rgba(255, 215, 0, 0.2), var(--bg-secondary));
+  917         }
+  918 
+  919         .sequence-item.correct {
+  920             border-color: var(--accent-1);
+  921             background: linear-gradient(145deg, rgba(0, 255, 136, 0.2), var(--bg-secondary));
+  922             animation: correctPop 0.4s ease;
+  923         }
+  924 
+  925         @keyframes correctPop {
+  926             0% { transform: scale(1); }
+  927             50% { transform: scale(1.15); }
+  928             100% { transform: scale(1); }
+  929         }
+  930 
+  931         .sequence-hint {
+  932             text-align: center;
+  933             margin-bottom: 20px;
+  934             padding: 15px;
+  935             background: rgba(0, 212, 255, 0.1);
+  936             border-radius: 12px;
+  937             border: 1px solid rgba(0, 212, 255, 0.3);
+  938         }
+  939 
+  940         .sequence-hint-text {
+  941             font-family: 'Noto Sans HK', sans-serif;
+  942             font-size: 0.85rem;
+  943             color: var(--accent-2);
+  944         }
+  945 
+  946         .sequence-actions {
+  947             display: grid;
+  948             grid-template-columns: repeat(2, 1fr);
+  949             gap: 16px;
+  950         }
+  951 
+  952         .sequence-status {
+  953             text-align: center;
+  954             margin-top: 20px;
+  955             padding: 16px;
+  956             border-radius: 12px;
+  957             font-size: 0.9rem;
+  958             font-weight: 700;
+  959             opacity: 0;
+  960             transform: translateY(-10px);
+  961             transition: all 0.3s;
+  962         }
+  963 
+  964         .sequence-status.show {
+  965             opacity: 1;
+  966             transform: translateY(0);
+  967         }
+  968 
+  969         .sequence-status.error {
+  970             background: rgba(255, 64, 129, 0.2);
+  971             color: #ff4081;
+  972             border: 2px solid #ff4081;
+  973         }
+  974 
+  975         .sequence-success-overlay {
+  976             position: absolute;
+  977             top: 0;
+  978             left: 0;
+  979             width: 100%;
+  980             height: 100%;
+  981             background: radial-gradient(circle, var(--accent-1), var(--accent-2));
+  982             opacity: 0;
+  983             pointer-events: none;
+  984             display: flex;
+  985             align-items: center;
+  986             justify-content: center;
+  987             border-radius: 32px;
+  988             transition: opacity 0.3s;
+  989         }
+  990 
+  991         .sequence-success-overlay.show {
+  992             opacity: 0.95;
+  993             pointer-events: auto;
+  994             animation: successPulse 0.6s;
+  995         }
+  996 
+  997         /* ========== PASSWORD GAME STYLES ========== */
+  998         .password-container {
+  999             width: 100%;
+ 1000             max-width: 450px;
+ 1001             background: var(--bg-secondary);
+ 1002             border-radius: 32px;
+ 1003             padding: 40px 30px;
+ 1004             box-shadow:
+ 1005                 0 20px 60px rgba(0, 0, 0, 0.3),
+ 1006                 inset 0 1px 0 rgba(255, 255, 255, 0.1);
+ 1007             position: relative;
+ 1008             overflow: hidden;
+ 1009             animation: slideUp 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
+ 1010         }
+ 1011 
+ 1012         .password-header {
+ 1013             text-align: center;
+ 1014             margin-bottom: 30px;
+ 1015         }
+ 1016 
+ 1017         .password-title {
+ 1018             font-family: 'Orbitron', sans-serif;
+ 1019             font-size: 1.5rem;
+ 1020             font-weight: 900;
+ 1021             background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
+ 1022             -webkit-background-clip: text;
+ 1023             -webkit-text-fill-color: transparent;
+ 1024             background-clip: text;
+ 1025             letter-spacing: 2px;
+ 1026             margin-bottom: 8px;
+ 1027         }
+ 1028 
+ 1029         .password-subtitle {
+ 1030             font-family: 'Noto Sans HK', sans-serif;
+ 1031             font-size: 0.9rem;
+ 1032             color: var(--text-secondary);
+ 1033         }
+ 1034 
+ 1035         .password-display {
+ 1036             display: flex;
+ 1037             justify-content: center;
+ 1038             gap: 12px;
+ 1039             margin-bottom: 30px;
+ 1040         }
+ 1041 
+ 1042         .password-slot {
+ 1043             width: 70px;
+ 1044             height: 90px;
+ 1045             background: var(--bg-primary);
+ 1046             border: 3px solid var(--accent-2);
+ 1047             border-radius: 16px;
+ 1048             display: flex;
+ 1049             align-items: center;
+ 1050             justify-content: center;
+ 1051             font-family: 'Orbitron', sans-serif;
+ 1052             font-size: 2.5rem;
+ 1053             font-weight: 900;
+ 1054             color: var(--text-primary);
+ 1055             box-shadow:
+ 1056                 inset 0 2px 8px rgba(0, 0, 0, 0.3),
+ 1057                 0 4px 15px rgba(0, 0, 0, 0.2);
+ 1058             transition: all 0.2s ease;
+ 1059         }
+ 1060 
+ 1061         .password-slot.active {
+ 1062             border-color: var(--accent-1);
+ 1063             box-shadow:
+ 1064                 inset 0 2px 8px rgba(0, 0, 0, 0.3),
+ 1065                 0 0 20px var(--shadow-glow);
+ 1066         }
+ 1067 
+ 1068         .password-slot.filled {
+ 1069             color: var(--accent-1);
+ 1070             text-shadow: 0 0 15px var(--shadow-glow);
+ 1071         }
+ 1072 
+ 1073         .password-keypad {
+ 1074             display: grid;
+ 1075             grid-template-columns: repeat(3, 1fr);
+ 1076             gap: 12px;
+ 1077             margin-bottom: 20px;
+ 1078         }
+ 1079 
+ 1080         .password-key {
+ 1081             padding: 20px;
+ 1082             background: var(--bg-button);
+ 1083             border: none;
+ 1084             border-radius: 14px;
+ 1085             font-family: 'JetBrains Mono', monospace;
+ 1086             font-size: 1.4rem;
+ 1087             font-weight: 700;
+ 1088             color: var(--text-primary);
+ 1089             cursor: pointer;
+ 1090             transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
+ 1091             box-shadow:
+ 1092                 0 4px 12px rgba(0, 0, 0, 0.2),
+ 1093                 inset 0 1px 0 rgba(255, 255, 255, 0.1);
+ 1094             -webkit-tap-highlight-color: transparent;
+ 1095             user-select: none;
+ 1096             touch-action: manipulation;
+ 1097         }
+ 1098 
+ 1099         .password-key:hover {
+ 1100             transform: scale(1.05);
+ 1101             box-shadow:
+ 1102                 0 6px 20px rgba(0, 0, 0, 0.3),
+ 1103                 0 0 15px var(--shadow-glow);
+ 1104         }
+ 1105 
+ 1106         .password-key:active {
+ 1107             transform: scale(0.95);
+ 1108         }
+ 1109 
+ 1110         .password-key.backspace {
+ 1111             background: linear-gradient(135deg, #ff4081, #ff1744);
+ 1112             color: white;
+ 1113             font-size: 1.2rem;
+ 1114         }
+ 1115 
+ 1116         .password-actions {
+ 1117             display: grid;
+ 1118             grid-template-columns: repeat(2, 1fr);
+ 1119             gap: 16px;
+ 1120         }
+ 1121 
+ 1122         .password-status {
+ 1123             text-align: center;
+ 1124             margin-top: 20px;
+ 1125             padding: 16px;
+ 1126             border-radius: 12px;
+ 1127             font-size: 0.9rem;
+ 1128             font-weight: 700;
+ 1129             opacity: 0;
+ 1130             transform: translateY(-10px);
+ 1131             transition: all 0.3s;
+ 1132         }
+ 1133 
+ 1134         .password-status.show {
+ 1135             opacity: 1;
+ 1136             transform: translateY(0);
+ 1137         }
+ 1138 
+ 1139         .password-status.error {
+ 1140             background: rgba(255, 64, 129, 0.2);
+ 1141             color: #ff4081;
+ 1142             border: 2px solid #ff4081;
+ 1143         }
+ 1144 
+ 1145         .password-success-overlay {
+ 1146             position: absolute;
+ 1147             top: 0;
+ 1148             left: 0;
+ 1149             width: 100%;
+ 1150             height: 100%;
+ 1151             background: radial-gradient(circle, var(--accent-1), var(--accent-2));
+ 1152             opacity: 0;
+ 1153             pointer-events: none;
+ 1154             display: flex;
+ 1155             align-items: center;
+ 1156             justify-content: center;
+ 1157             border-radius: 32px;
+ 1158             transition: opacity 0.3s;
+ 1159         }
+ 1160 
+ 1161         .password-success-overlay.show {
+ 1162             opacity: 0.95;
+ 1163             pointer-events: auto;
+ 1164             animation: successPulse 0.6s;
+ 1165         }
+ 1166 
+ 1167         /* ========== TEXT INPUT GAME STYLES ========== */
+ 1168         .textinput-container {
+ 1169             width: 100%;
+ 1170             max-width: 500px;
+ 1171             background: var(--bg-secondary);
+ 1172             border-radius: 32px;
+ 1173             padding: 40px 30px;
+ 1174             box-shadow:
+ 1175                 0 20px 60px rgba(0, 0, 0, 0.3),
+ 1176                 inset 0 1px 0 rgba(255, 255, 255, 0.1);
+ 1177             position: relative;
+ 1178             overflow: hidden;
+ 1179             animation: slideUp 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
+ 1180         }
+ 1181 
+ 1182         .textinput-header {
+ 1183             text-align: center;
+ 1184             margin-bottom: 30px;
+ 1185         }
+ 1186 
+ 1187         .textinput-title {
+ 1188             font-family: 'Orbitron', sans-serif;
+ 1189             font-size: 1.5rem;
+ 1190             font-weight: 900;
+ 1191             background: linear-gradient(135deg, var(--accent-1), var(--accent-2));
+ 1192             -webkit-background-clip: text;
+ 1193             -webkit-text-fill-color: transparent;
+ 1194             background-clip: text;
+ 1195             letter-spacing: 2px;
+ 1196             margin-bottom: 8px;
+ 1197         }
+ 1198 
+ 1199         .textinput-subtitle {
+ 1200             font-family: 'Noto Sans HK', sans-serif;
+ 1201             font-size: 0.9rem;
+ 1202             color: var(--text-secondary);
+ 1203         }
+ 1204 
+ 1205         .textinput-display {
+ 1206             display: flex;
+ 1207             justify-content: center;
+ 1208             gap: 12px;
+ 1209             margin-bottom: 30px;
+ 1210         }
+ 1211 
+ 1212         .textinput-slot {
+ 1213             width: 70px;
+ 1214             height: 90px;
+ 1215             background: var(--bg-primary);
+ 1216             border: 3px solid var(--accent-2);
+ 1217             border-radius: 16px;
+ 1218             display: flex;
+ 1219             align-items: center;
+ 1220             justify-content: center;
+ 1221             font-family: 'Orbitron', sans-serif;
+ 1222             font-size: 2.2rem;
+ 1223             font-weight: 900;
+ 1224             color: var(--text-primary);
+ 1225             box-shadow:
+ 1226                 inset 0 2px 8px rgba(0, 0, 0, 0.3),
+ 1227                 0 4px 15px rgba(0, 0, 0, 0.2);
+ 1228             transition: all 0.2s ease;
+ 1229             text-transform: uppercase;
+ 1230         }
+ 1231 
+ 1232         .textinput-slot.active {
+ 1233             border-color: var(--accent-1);
+ 1234             box-shadow:
+ 1235                 inset 0 2px 8px rgba(0, 0, 0, 0.3),
+ 1236                 0 0 20px var(--shadow-glow);
+ 1237         }
+ 1238 
+ 1239         .textinput-slot.filled {
+ 1240             color: var(--accent-1);
+ 1241             text-shadow: 0 0 15px var(--shadow-glow);
+ 1242         }
+ 1243 
+ 1244         .textinput-hint {
+ 1245             text-align: center;
+ 1246             margin-bottom: 25px;
+ 1247             padding: 15px;
+ 1248             background: rgba(0, 212, 255, 0.1);
+ 1249             border-radius: 12px;
+ 1250             border: 1px solid rgba(0, 212, 255, 0.3);
+ 1251         }
+ 1252 
+ 1253         .textinput-hint-text {
+ 1254             font-family: 'Noto Sans HK', sans-serif;
+ 1255             font-size: 0.85rem;
+ 1256             color: var(--accent-2);
+ 1257         }
+ 1258 
+ 1259         .textinput-keyboard {
+ 1260             display: flex;
+ 1261             flex-direction: column;
+ 1262             gap: 8px;
+ 1263             margin-bottom: 20px;
+ 1264         }
+ 1265 
+ 1266         .keyboard-row {
+ 1267             display: flex;
+ 1268             justify-content: center;
+ 1269             gap: 6px;
+ 1270         }
+ 1271 
+ 1272         .textinput-key {
+ 1273             min-width: 38px;
+ 1274             height: 45px;
+ 1275             background: var(--bg-button);
+ 1276             border: none;
+ 1277             border-radius: 10px;
+ 1278             font-family: 'JetBrains Mono', monospace;
+ 1279             font-size: 1.1rem;
+ 1280             font-weight: 700;
+ 1281             color: var(--text-primary);
+ 1282             cursor: pointer;
+ 1283             transition: all 0.15s ease;
+ 1284             box-shadow:
+ 1285                 0 3px 8px rgba(0, 0, 0, 0.2),
+ 1286                 inset 0 1px 0 rgba(255, 255, 255, 0.1);
+ 1287             -webkit-tap-highlight-color: transparent;
+ 1288             user-select: none;
+ 1289             touch-action: manipulation;
+ 1290             text-transform: uppercase;
+ 1291         }
+ 1292 
+ 1293         .textinput-key:hover {
+ 1294             transform: scale(1.08);
+ 1295             background: var(--accent-2);
+ 1296             color: var(--bg-primary);
+ 1297         }
+ 1298 
+ 1299         .textinput-key:active {
+ 1300             transform: scale(0.95);
+ 1301         }
+ 1302 
+ 1303         .textinput-key.wide {
+ 1304             min-width: 70px;
+ 1305             font-size: 0.9rem;
+ 1306         }
+ 1307 
+ 1308         .textinput-key.backspace {
+ 1309             background: linear-gradient(135deg, #ff4081, #ff1744);
+ 1310             color: white;
+ 1311         }
+ 1312 
+ 1313         .textinput-actions {
+ 1314             display: grid;
+ 1315             grid-template-columns: repeat(2, 1fr);
+ 1316             gap: 16px;
+ 1317         }
+ 1318 
+ 1319         .textinput-status {
+ 1320             text-align: center;
+ 1321             margin-top: 20px;
+ 1322             padding: 16px;
+ 1323             border-radius: 12px;
+ 1324             font-size: 0.9rem;
+ 1325             font-weight: 700;
+ 1326             opacity: 0;
+ 1327             transform: translateY(-10px);
+ 1328             transition: all 0.3s;
+ 1329         }
+ 1330 
+ 1331         .textinput-status.show {
+ 1332             opacity: 1;
+ 1333             transform: translateY(0);
+ 1334         }
+ 1335 
+ 1336         .textinput-status.error {
+ 1337             background: rgba(255, 64, 129, 0.2);
+ 1338             color: #ff4081;
+ 1339             border: 2px solid #ff4081;
+ 1340         }
+ 1341 
+ 1342         .textinput-success-overlay {
+ 1343             position: absolute;
+ 1344             top: 0;
+ 1345             left: 0;
+ 1346             width: 100%;
+ 1347             height: 100%;
+ 1348             background: radial-gradient(circle, var(--accent-1), var(--accent-2));
+ 1349             opacity: 0;
+ 1350             pointer-events: none;
+ 1351             display: flex;
+ 1352             align-items: center;
+ 1353             justify-content: center;
+ 1354             border-radius: 32px;
+ 1355             transition: opacity 0.3s;
+ 1356         }
+ 1357 
+ 1358         .textinput-success-overlay.show {
+ 1359             opacity: 0.95;
+ 1360             pointer-events: auto;
+ 1361             animation: successPulse 0.6s;
+ 1362         }
+ 1363 
+ 1364         @media (max-width: 480px) {
+ 1365             .timer-container, .level-indicator {
+ 1366                 padding: 8px 14px;
+ 1367             }
+ 1368 
+ 1369             .timer-display {
+ 1370                 font-size: 0.9rem;
+ 1371             }
+ 1372 
+ 1373             .level-text {
+ 1374                 font-size: 0.8rem;
+ 1375             }
+ 1376 
+ 1377             .level-dot {
+ 1378                 width: 8px;
+ 1379                 height: 8px;
+ 1380             }
+ 1381 
+ 1382             .intro-flow {
+ 1383                 padding: 40px 25px;
+ 1384             }
+ 1385 
+ 1386             .intro-title {
+ 1387                 font-size: 2rem;
+ 1388             }
+ 1389 
+ 1390             .intro-quote {
+ 1391                 font-size: 1.1rem;
+ 1392                 padding: 20px;
+ 1393             }
+ 1394 
+ 1395             .start-btn {
+ 1396                 padding: 18px 40px;
+ 1397                 font-size: 1.1rem;
+ 1398             }
+ 1399 
+ 1400             .envelope-message {
+ 1401                 font-size: 1.5rem;
+ 1402                 padding: 30px 20px;
+ 1403             }
+ 1404 
+ 1405             .phone-container {
+ 1406                 padding: 30px 20px;
+ 1407             }
+ 1408 
+ 1409             .display-number {
+ 1410                 font-size: 1.5rem;
+ 1411             }
+ 1412 
+ 1413             .key {
+ 1414                 font-size: 1.2rem;
+ 1415             }
+ 1416 
+ 1417             .final-title {
+ 1418                 font-size: 1.8rem;
+ 1419             }
+ 1420 
+ 1421             .final-time {
+ 1422                 font-size: 2.5rem;
+ 1423             }
+ 1424 
+ 1425             .final-trophy {
+ 1426                 font-size: 4rem;
+ 1427             }
+ 1428 
+ 1429             .sequence-container {
+ 1430                 padding: 30px 20px;
+ 1431             }
+ 1432 
+ 1433             .sequence-item {
+ 1434                 width: 45px;
+ 1435                 height: 45px;
+ 1436                 font-size: 1.2rem;
+ 1437             }
+ 1438 
+ 1439             .sequence-slots {
+ 1440                 gap: 8px;
+ 1441             }
+ 1442 
+ 1443             .password-slot {
+ 1444                 width: 55px;
+ 1445                 height: 75px;
+ 1446                 font-size: 2rem;
+ 1447             }
+ 1448 
+ 1449             .password-key {
+ 1450                 padding: 16px;
+ 1451                 font-size: 1.2rem;
+ 1452             }
+ 1453 
+ 1454             .textinput-slot {
+ 1455                 width: 55px;
+ 1456                 height: 70px;
+ 1457                 font-size: 1.8rem;
+ 1458             }
+ 1459 
+ 1460             .textinput-key {
+ 1461                 min-width: 30px;
+ 1462                 height: 40px;
+ 1463                 font-size: 0.95rem;
+ 1464             }
+ 1465 
+ 1466             .textinput-key.wide {
+ 1467                 min-width: 55px;
+ 1468             }
+ 1469 
+ 1470             .timer-penalty {
+ 1471                 top: 60px;
+ 1472                 right: 10px;
+ 1473                 padding: 8px 14px;
+ 1474                 font-size: 0.85rem;
+ 1475             }
+ 1476         }
+ 1477     </style>
+ 1478 </head>
+ 1479 <body>
+ 1480     <!-- Timer Display -->
+ 1481     <div class="timer-container" id="timerContainer">
+ 1482         <span class="timer-icon">â±ï¸</span>
+ 1483         <span class="timer-display" id="timerDisplay">60:00</span>
+ 1484     </div>
+ 1485 
+ 1486     <!-- Timer Penalty Indicator -->
+ 1487     <div class="timer-penalty" id="timerPenalty">-5:00</div>
+ 1488 
+ 1489     <!-- Level Indicator -->
+ 1490     <div class="level-indicator" id="levelIndicator">
+ 1491         <span class="level-text">é—œå¡</span>
+ 1492         <div class="level-dots">
+ 1493             <div class="level-dot current" id="dot1"></div>
+ 1494             <div class="level-dot" id="dot2"></div>
+ 1495             <div class="level-dot" id="dot3"></div>
+ 1496             <div class="level-dot" id="dot4"></div>
+ 1497             <div class="level-dot" id="dot5"></div>
+ 1498         </div>
+ 1499     </div>
+ 1500 
+ 1501     <!-- Intro Flow Container -->
+ 1502     <div class="intro-flow" id="introFlow">
+ 1503         <!-- Step 1: Start -->
+ 1504         <div class="intro-step active" id="step1">
+ 1505             <h1 class="intro-title">é–‹å§‹é«”é©—</h1>
+ 1506             <button class="start-btn" id="startBtn">é–‹å§‹</button>
+ 1507         </div>
+ 1508 
+ 1509         <!-- Step 2: Quote with sounds -->
+ 1510         <div class="intro-step" id="step2">
+ 1511             <div class="intro-quote" id="quoteText">
+ 1512                 è«‹é–±è®€å¼•æ–‡
+ 1513             </div>
+ 1514             <div class="audio-indicator" id="audioIndicator">æ’­æ”¾ä¸­...</div>
+ 1515             <button class="next-btn" id="nextBtn1">ä¸‹ä¸€æ­¥</button>
+ 1516         </div>
+ 1517 
+ 1518         <!-- Step 3: Boss opening speech -->
+ 1519         <div class="intro-step" id="step3">
+ 1520             <h2 class="intro-title" style="font-size: 1.8rem;">è†è½è¨Šæ¯</h2>
+ 1521             <div class="audio-indicator" id="bossAudioIndicator">æ’­æ”¾è€é—†é–‹å ´ç™½...</div>
+ 1522             <button class="next-btn hidden" id="nextBtn2">ç¹¼çºŒ</button>
+ 1523         </div>
+ 1524 
+ 1525         <!-- Step 4: Envelope message -->
+ 1526         <div class="intro-step" id="step4">
+ 1527             <span class="envelope-icon">âœ‰ï¸</span>
+ 1528             <div class="envelope-message" id="envelopeMessage">
+ 1529                 è«‹æ‰“é–‹1è™Ÿä¿¡å°
+ 1530             </div>
+ 1531             <button class="next-btn" id="continueToPhoneBtn">ç¹¼çºŒ</button>
+ 1532         </div>
+ 1533     </div>
+ 1534 
+ 1535     <!-- Phone Container (hidden initially) -->
+ 1536     <div class="phone-container hidden" id="phoneContainer">
+ 1537         <div class="phone-header">
+ 1538             <h1 class="phone-title">é›»è©±è¼¸å…¥å™¨</h1>
+ 1539             <p class="phone-subtitle">è«‹è¼¸å…¥é›»è©±è™Ÿç¢¼</p>
+ 1540         </div>
+ 1541 
+ 1542         <div class="display">
+ 1543             <div class="display-number empty" id="display">Enter Number</div>
+ 1544         </div>
+ 1545 
+ 1546         <div class="keypad">
+ 1547             <button class="key" data-num="1">1</button>
+ 1548             <button class="key" data-num="2">2</button>
+ 1549             <button class="key" data-num="3">3</button>
+ 1550             <button class="key" data-num="4">4</button>
+ 1551             <button class="key" data-num="5">5</button>
+ 1552             <button class="key" data-num="6">6</button>
+ 1553             <button class="key" data-num="7">7</button>
+ 1554             <button class="key" data-num="8">8</button>
+ 1555             <button class="key" data-num="9">9</button>
+ 1556             <button class="key special" data-num="*">*</button>
+ 1557             <button class="key" data-num="0">0</button>
+ 1558             <button class="key special" data-num="#">#</button>
+ 1559         </div>
+ 1560 
+ 1561         <div class="actions">
+ 1562             <button class="action-btn clear" id="clearBtn">Clear</button>
+ 1563             <button class="action-btn call" id="callBtn">Call</button>
+ 1564         </div>
+ 1565 
+ 1566         <div class="status-message" id="statusMessage"></div>
+ 1567 
+ 1568         <div class="success-overlay" id="successOverlay">
+ 1569             <div class="success-content">
+ 1570                 <div class="success-icon">ðŸŽ‰</div>
+ 1571                 <div class="success-text">ACCESS GRANTED</div>
+ 1572                 <div class="success-subtext">Correct code entered!</div>
+ 1573             </div>
+ 1574         </div>
+ 1575     </div>
+ 1576 
+ 1577     <!-- Sequence Game Container (Level 2) -->
+ 1578     <div class="sequence-container hidden" id="sequenceContainer">
+ 1579         <div class="sequence-header">
+ 1580             <h1 class="sequence-title">æ•¸å­—æŽ’åº</h1>
+ 1581             <p class="sequence-subtitle">æ‹–å‹•æ•¸å­—åˆ°æ­£ç¢ºä½ç½®</p>
+ 1582         </div>
+ 1583 
+ 1584         <div class="sequence-hint">
+ 1585             <p class="sequence-hint-text">ðŸ’¡ æ‹–æ”¾æ•¸å­—é‡æ–°æŽ’åˆ—é †åº</p>
+ 1586         </div>
+ 1587 
+ 1588         <div class="sequence-area">
+ 1589             <div class="sequence-slots" id="sequenceSlots">
+ 1590                 <!-- Numbers will be inserted by JS -->
+ 1591             </div>
+ 1592         </div>
+ 1593 
+ 1594         <div class="sequence-actions">
+ 1595             <button class="action-btn clear" id="sequenceResetBtn">é‡ç½®</button>
+ 1596             <button class="action-btn call" id="sequenceSubmitBtn">ç¢ºèª</button>
+ 1597         </div>
+ 1598 
+ 1599         <div class="sequence-status" id="sequenceStatus"></div>
+ 1600 
+ 1601         <div class="sequence-success-overlay" id="sequenceSuccessOverlay">
+ 1602             <div class="success-content">
+ 1603                 <div class="success-icon">âœ…</div>
+ 1604                 <div class="success-text">æŽ’åºæ­£ç¢ºï¼</div>
+ 1605                 <div class="success-subtext">ç¹¼çºŒä¸‹ä¸€é—œï¼</div>
+ 1606             </div>
+ 1607         </div>
+ 1608     </div>
+ 1609 
+ 1610     <!-- Password Game Container (Level 3) -->
+ 1611     <div class="password-container hidden" id="passwordContainer">
+ 1612         <div class="password-header">
+ 1613             <h1 class="password-title">ðŸ” å¯†ç¢¼éŽ–</h1>
+ 1614             <p class="password-subtitle">è¼¸å…¥3ä½æ•¸å¯†ç¢¼ (000-999)</p>
+ 1615         </div>
+ 1616 
+ 1617         <div class="password-display" id="passwordDisplay">
+ 1618             <div class="password-slot active" id="pwSlot0">_</div>
+ 1619             <div class="password-slot" id="pwSlot1">_</div>
+ 1620             <div class="password-slot" id="pwSlot2">_</div>
+ 1621         </div>
+ 1622 
+ 1623         <div class="password-keypad">
+ 1624             <button class="password-key" data-num="1">1</button>
+ 1625             <button class="password-key" data-num="2">2</button>
+ 1626             <button class="password-key" data-num="3">3</button>
+ 1627             <button class="password-key" data-num="4">4</button>
+ 1628             <button class="password-key" data-num="5">5</button>
+ 1629             <button class="password-key" data-num="6">6</button>
+ 1630             <button class="password-key" data-num="7">7</button>
+ 1631             <button class="password-key" data-num="8">8</button>
+ 1632             <button class="password-key" data-num="9">9</button>
+ 1633             <button class="password-key backspace" data-num="back">âŒ«</button>
+ 1634             <button class="password-key" data-num="0">0</button>
+ 1635             <button class="password-key" data-num="enter">âœ“</button>
+ 1636         </div>
+ 1637 
+ 1638         <div class="password-actions">
+ 1639             <button class="action-btn clear" id="passwordClearBtn">æ¸…é™¤</button>
+ 1640             <button class="action-btn call" id="passwordSubmitBtn">ç¢ºèª</button>
+ 1641         </div>
+ 1642 
+ 1643         <div class="password-status" id="passwordStatus"></div>
+ 1644 
+ 1645         <div class="password-success-overlay" id="passwordSuccessOverlay">
+ 1646             <div class="success-content">
+ 1647                 <div class="success-icon">ðŸ”“</div>
+ 1648                 <div class="success-text">å¯†ç¢¼æ­£ç¢ºï¼</div>
+ 1649                 <div class="success-subtext">ç¹¼çºŒä¸‹ä¸€é—œï¼</div>
+ 1650             </div>
+ 1651         </div>
+ 1652     </div>
+ 1653 
+ 1654     <!-- Text Input Game Container (Level 4) -->
+ 1655     <div class="textinput-container hidden" id="textinputContainer">
+ 1656         <div class="textinput-header">
+ 1657             <h1 class="textinput-title">ðŸ”¤ ä»£ç¢¼è¼¸å…¥</h1>
+ 1658             <p class="textinput-subtitle">è¼¸å…¥4ä½æ•¸å­—æˆ–å­—æ¯ä»£ç¢¼</p>
+ 1659         </div>
+ 1660 
+ 1661         <div class="textinput-hint">
+ 1662             <p class="textinput-hint-text">âŒ¨ï¸ ä½¿ç”¨ä¸‹æ–¹éµç›¤æˆ–å¯¦é«”éµç›¤è¼¸å…¥</p>
+ 1663         </div>
+ 1664 
+ 1665         <div class="textinput-display" id="textinputDisplay">
+ 1666             <div class="textinput-slot active" id="tiSlot0">_</div>
+ 1667             <div class="textinput-slot" id="tiSlot1">_</div>
+ 1668             <div class="textinput-slot" id="tiSlot2">_</div>
+ 1669             <div class="textinput-slot" id="tiSlot3">_</div>
+ 1670         </div>
+ 1671 
+ 1672         <div class="textinput-keyboard">
+ 1673             <div class="keyboard-row">
+ 1674                 <button class="textinput-key" data-char="1">1</button>
+ 1675                 <button class="textinput-key" data-char="2">2</button>
+ 1676                 <button class="textinput-key" data-char="3">3</button>
+ 1677                 <button class="textinput-key" data-char="4">4</button>
+ 1678                 <button class="textinput-key" data-char="5">5</button>
+ 1679                 <button class="textinput-key" data-char="6">6</button>
+ 1680                 <button class="textinput-key" data-char="7">7</button>
+ 1681                 <button class="textinput-key" data-char="8">8</button>
+ 1682                 <button class="textinput-key" data-char="9">9</button>
+ 1683                 <button class="textinput-key" data-char="0">0</button>
+ 1684             </div>
+ 1685             <div class="keyboard-row">
+ 1686                 <button class="textinput-key" data-char="Q">Q</button>
+ 1687                 <button class="textinput-key" data-char="W">W</button>
+ 1688                 <button class="textinput-key" data-char="E">E</button>
+ 1689                 <button class="textinput-key" data-char="R">R</button>
+ 1690                 <button class="textinput-key" data-char="T">T</button>
+ 1691                 <button class="textinput-key" data-char="Y">Y</button>
+ 1692                 <button class="textinput-key" data-char="U">U</button>
+ 1693                 <button class="textinput-key" data-char="I">I</button>
+ 1694                 <button class="textinput-key" data-char="O">O</button>
+ 1695                 <button class="textinput-key" data-char="P">P</button>
+ 1696             </div>
+ 1697             <div class="keyboard-row">
+ 1698                 <button class="textinput-key" data-char="A">A</button>
+ 1699                 <button class="textinput-key" data-char="S">S</button>
+ 1700                 <button class="textinput-key" data-char="D">D</button>
+ 1701                 <button class="textinput-key" data-char="F">F</button>
+ 1702                 <button class="textinput-key" data-char="G">G</button>
+ 1703                 <button class="textinput-key" data-char="H">H</button>
+ 1704                 <button class="textinput-key" data-char="J">J</button>
+ 1705                 <button class="textinput-key" data-char="K">K</button>
+ 1706                 <button class="textinput-key" data-char="L">L</button>
+ 1707             </div>
+ 1708             <div class="keyboard-row">
+ 1709                 <button class="textinput-key" data-char="Z">Z</button>
+ 1710                 <button class="textinput-key" data-char="X">X</button>
+ 1711                 <button class="textinput-key" data-char="C">C</button>
+ 1712                 <button class="textinput-key" data-char="V">V</button>
+ 1713                 <button class="textinput-key" data-char="B">B</button>
+ 1714                 <button class="textinput-key" data-char="N">N</button>
+ 1715                 <button class="textinput-key" data-char="M">M</button>
+ 1716                 <button class="textinput-key wide backspace" data-char="back">âŒ«</button>
+ 1717             </div>
+ 1718         </div>
+ 1719 
+ 1720         <div class="textinput-actions">
+ 1721             <button class="action-btn clear" id="textinputClearBtn">æ¸…é™¤</button>
+ 1722             <button class="action-btn call" id="textinputSubmitBtn">ç¢ºèª</button>
+ 1723         </div>
+ 1724 
+ 1725         <div class="textinput-status" id="textinputStatus"></div>
+ 1726 
+ 1727         <div class="textinput-success-overlay" id="textinputSuccessOverlay">
+ 1728             <div class="success-content">
+ 1729                 <div class="success-icon">âœ…</div>
+ 1730                 <div class="success-text">ä»£ç¢¼æ­£ç¢ºï¼</div>
+ 1731                 <div class="success-subtext">ç¹¼çºŒä¸‹ä¸€é—œï¼</div>
+ 1732             </div>
+ 1733         </div>
+ 1734     </div>
+ 1735 
+ 1736     <!-- Final Screen (hidden initially) -->
+ 1737     <div class="final-screen hidden" id="finalScreen">
+ 1738         <div class="final-trophy">ðŸ†</div>
+ 1739         <h1 class="final-title">ä»»å‹™å®Œæˆï¼</h1>
+ 1740         <p class="final-time-label">ç¸½ç”¨æ™‚</p>
+ 1741         <div class="final-time" id="finalTime">00:00</div>
+ 1742         <div class="final-stats">
+ 1743             <div class="stat-box">
+ 1744                 <div class="stat-value">5</div>
+ 1745                 <div class="stat-label">å®Œæˆé—œå¡</div>
+ 1746             </div>
+ 1747             <div class="stat-box">
+ 1748                 <div class="stat-value" id="finalMinutes">0</div>
+ 1749                 <div class="stat-label">åˆ†é˜</div>
+ 1750             </div>
+ 1751             <div class="stat-box">
+ 1752                 <div class="stat-value" id="finalSeconds">0</div>
+ 1753                 <div class="stat-label">ç§’</div>
+ 1754             </div>
+ 1755         </div>
+ 1756     </div>
+ 1757 
+ 1758     <script>
+ 1759         // Detect color scheme preference
+ 1760         if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
+ 1761             document.documentElement.classList.add('dark');
+ 1762         }
+ 1763         window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
+ 1764             if (event.matches) {
+ 1765                 document.documentElement.classList.add('dark');
+ 1766             } else {
+ 1767                 document.documentElement.classList.remove('dark');
+ 1768             }
+ 1769         });
+ 1770 
+ 1771         // ========== TIMER LOGIC ==========
+ 1772         let timerInterval = null;
+ 1773         let startTime = null;
+ 1774         let elapsedSeconds = 0;
+ 1775         let penaltySeconds = 0;
+ 1776         const TOTAL_TIME = 60 * 60; // 60 minutes in seconds
+ 1777         const PENALTY_TIME = 5 * 60; // 5 minutes penalty in seconds
+ 1778 
+ 1779         function startTimer() {
+ 1780             startTime = Date.now();
+ 1781             document.getElementById('timerContainer').classList.add('active');
+ 1782             document.getElementById('levelIndicator').classList.add('active');
+ 1783 
+ 1784             timerInterval = setInterval(() => {
+ 1785                 elapsedSeconds = Math.floor((Date.now() - startTime) / 1000) + penaltySeconds;
+ 1786                 const remainingSeconds = TOTAL_TIME - elapsedSeconds;
+ 1787 
+ 1788                 if (remainingSeconds <= 0) {
+ 1789                     clearInterval(timerInterval);
+ 1790                     document.getElementById('timerDisplay').textContent = '00:00';
+ 1791                     return;
+ 1792                 }
+ 1793 
+ 1794                 const minutes = Math.floor(remainingSeconds / 60);
+ 1795                 const seconds = remainingSeconds % 60;
+ 1796                 document.getElementById('timerDisplay').textContent =
+ 1797                     `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
+ 1798 
+ 1799                 const timerContainer = document.getElementById('timerContainer');
+ 1800                 if (remainingSeconds <= 60) {
+ 1801                     timerContainer.classList.add('danger');
+ 1802                     timerContainer.classList.remove('warning');
+ 1803                 } else if (remainingSeconds <= 300) {
+ 1804                     timerContainer.classList.add('warning');
+ 1805                     timerContainer.classList.remove('danger');
+ 1806                 } else {
+ 1807                     timerContainer.classList.remove('warning', 'danger');
+ 1808                 }
+ 1809             }, 1000);
+ 1810         }
+ 1811 
+ 1812         function applyTimePenalty() {
+ 1813             penaltySeconds += PENALTY_TIME;
+ 1814             
+ 1815             // Show penalty indicator
+ 1816             const penaltyEl = document.getElementById('timerPenalty');
+ 1817             penaltyEl.classList.add('show');
+ 1818             
+ 1819             // Flash the timer red
+ 1820             const timerContainer = document.getElementById('timerContainer');
+ 1821             timerContainer.classList.add('danger');
+ 1822             
+ 1823             setTimeout(() => {
+ 1824                 penaltyEl.classList.remove('show');
+ 1825             }, 2000);
+ 1826             
+ 1827             // Update timer immediately to show the deduction
+ 1828             elapsedSeconds = Math.floor((Date.now() - startTime) / 1000) + penaltySeconds;
+ 1829             const remainingSeconds = Math.max(0, TOTAL_TIME - elapsedSeconds);
+ 1830             const minutes = Math.floor(remainingSeconds / 60);
+ 1831             const seconds = remainingSeconds % 60;
+ 1832             document.getElementById('timerDisplay').textContent =
+ 1833                 `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
+ 1834         }
+ 1835 
+ 1836   function stopTimer() {
+ 1837             if (timerInterval) {
+ 1838                 clearInterval(timerInterval);
+ 1839                 timerInterval = null;
+ 1840             }
+ 1841             return elapsedSeconds;
+ 1842         }
+ 1843 
+ 1844         function getFormattedTime(totalSeconds) {
+ 1845             const minutes = Math.floor(totalSeconds / 60);
+ 1846             const seconds = totalSeconds % 60;
+ 1847             return {
+ 1848                 formatted: `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`,
+ 1849                 minutes,
+ 1850                 seconds
+ 1851             };
+ 1852         }
+ 1853 
+ 1854         // ========== LEVEL MANAGEMENT ==========
+ 1855         let currentLevel = 1;
+ 1856         const TOTAL_LEVELS = 5;
+ 1857 
+ 1858         // Level configurations
+ 1859         const LEVEL_CONFIG = {
+ 1860             1: {
+ 1861                 type: 'phone',
+ 1862                 correctAnswers: {
+ 1863                     '56123517': {
+ 1864                         overlayIcon: 'âœ…',
+ 1865                         overlayTitle: 'æŽ¥é€šäº†',
+ 1866                         overlaySubtext: 'ä½ å·²æŽ¥é€šè±¬è‚‰æ¦®ï¼',
+ 1867                         audioFile: 'è±¬è‚‰æ¦®.m4a'
+ 1868                     }
+ 1869                 },
+ 1870                 wrongAnswers: {
+ 1871                     '63589512': {
+ 1872                         message: 'æ‰“éŒ¯äº†ï¼é€™æ˜¯æŽå¤ªçš„é›»è©±ã€‚',
+ 1873                         audioFile: 'æŽå¤ª.m4a'
+ 1874                     },
+ 1875                     '97621245': {
+ 1876                         message: 'æ‰“éŒ¯äº†ï¼é€™æ˜¯å³å“¥çš„é›»è©±ã€‚',
+ 1877                         audioFile: 'å³å“¥.m4a'
+ 1878                     }
+ 1879                 },
+ 1880                 nextEnvelope: 'è«‹æ‰“é–‹2è™Ÿä¿¡å°'
+ 1881             },
+ 1882             2: {
+ 1883                 type: 'sequence',
+ 1884                 initialOrder: [1, 2, 3, 4, 5, 6, 7],
+ 1885                 correctOrder: [6, 1, 2, 7, 4, 3, 5],
+ 1886                 nextEnvelope: 'è«‹æ‰“é–‹3è™Ÿä¿¡å°'
+ 1887             },
+ 1888             3: {
+ 1889                 type: 'password',
+ 1890                 correctAnswer: '542',
+ 1891                 length: 3,
+ 1892                 nextEnvelope: 'è«‹æ‰“é–‹4è™Ÿä¿¡å°'
+ 1893             },
+ 1894             4: {
+ 1895                 type: 'textinput',
+ 1896                 correctAnswer: '027E',
+ 1897                 length: 4,
+ 1898                 nextEnvelope: 'è«‹æ‰“é–‹5è™Ÿä¿¡å°'
+ 1899             },
+ 1900             5: {
+ 1901                 type: 'phone',
+ 1902                 correctAnswers: {
+ 1903                     '99998888': {
+ 1904                         overlayIcon: 'ðŸŽ‰',
+ 1905                         overlayTitle: 'æ­å–œå®Œæˆï¼',
+ 1906                         overlaySubtext: 'æ‰€æœ‰é—œå¡å·²å®Œæˆï¼',
+ 1907                         audioFile: null
+ 1908                     }
+ 1909                 },
+ 1910                 wrongAnswers: {},
+ 1911                 nextEnvelope: null
+ 1912             }
+ 1913         };
+ 1914 
+ 1915         const DEFAULT_ERROR_MESSAGE = 'è™Ÿç¢¼éŒ¯èª¤ï¼Œè«‹é‡è©¦ï¼';
+ 1916         const DEFAULT_ERROR_AUDIO = null;
+ 1917 
+ 1918         function updateLevelIndicator() {
+ 1919             for (let i = 1; i <= TOTAL_LEVELS; i++) {
+ 1920                 const dot = document.getElementById(`dot${i}`);
+ 1921                 dot.classList.remove('completed', 'current');
+ 1922 
+ 1923                 if (i < currentLevel) {
+ 1924                     dot.classList.add('completed');
+ 1925                 } else if (i === currentLevel) {
+ 1926                     dot.classList.add('current');
+ 1927                 }
+ 1928             }
+ 1929         }
+ 1930 
+ 1931         function showGameForLevel(level) {
+ 1932             const config = LEVEL_CONFIG[level];
+ 1933 
+ 1934             // Hide all game containers
+ 1935             document.getElementById('phoneContainer').classList.add('hidden');
+ 1936             document.getElementById('sequenceContainer').classList.add('hidden');
+ 1937             document.getElementById('passwordContainer').classList.add('hidden');
+ 1938             document.getElementById('textinputContainer').classList.add('hidden');
+ 1939             document.getElementById('introFlow').classList.add('hidden');
+ 1940 
+ 1941             if (config.type === 'phone') {
+ 1942                 document.getElementById('phoneContainer').classList.remove('hidden');
+ 1943                 currentNumber = '';
+ 1944                 updateDisplay();
+ 1945             } else if (config.type === 'sequence') {
+ 1946                 document.getElementById('sequenceContainer').classList.remove('hidden');
+ 1947                 initSequenceGame();
+ 1948             } else if (config.type === 'password') {
+ 1949                 document.getElementById('passwordContainer').classList.remove('hidden');
+ 1950                 initPasswordGame();
+ 1951             } else if (config.type === 'textinput') {
+ 1952                 document.getElementById('textinputContainer').classList.remove('hidden');
+ 1953                 initTextInputGame();
+ 1954             }
+ 1955         }
+ 1956 
+ 1957         function advanceToNextLevel() {
+ 1958             if (currentLevel < TOTAL_LEVELS) {
+ 1959                 const nextEnvelope = LEVEL_CONFIG[currentLevel].nextEnvelope;
+ 1960                 currentLevel++;
+ 1961                 updateLevelIndicator();
+ 1962                 showEnvelopeScreen(nextEnvelope);
+ 1963             } else {
+ 1964                 showFinalScreen();
+ 1965             }
+ 1966         }
+ 1967 
+ 1968         function showFinalScreen() {
+ 1969             const finalSeconds = stopTimer();
+ 1970             const timeData = getFormattedTime(finalSeconds);
+ 1971 
+ 1972             document.getElementById('introFlow').classList.add('hidden');
+ 1973             document.getElementById('phoneContainer').classList.add('hidden');
+ 1974             document.getElementById('sequenceContainer').classList.add('hidden');
+ 1975             document.getElementById('passwordContainer').classList.add('hidden');
+ 1976             document.getElementById('textinputContainer').classList.add('hidden');
+ 1977             document.getElementById('timerContainer').classList.remove('active');
+ 1978             document.getElementById('levelIndicator').classList.remove('active');
+ 1979 
+ 1980             document.getElementById('finalTime').textContent = timeData.formatted;
+ 1981             document.getElementById('finalMinutes').textContent = timeData.minutes;
+ 1982             document.getElementById('finalSeconds').textContent = timeData.seconds;
+ 1983             document.getElementById('finalScreen').classList.remove('hidden');
+ 1984 
+ 1985             for (let i = 1; i <= TOTAL_LEVELS; i++) {
+ 1986                 const dot = document.getElementById(`dot${i}`);
+ 1987                 dot.classList.add('completed');
+ 1988                 dot.classList.remove('current');
+ 1989             }
+ 1990         }
+ 1991 
+ 1992         function showEnvelopeScreen(envelopeText) {
+ 1993             document.getElementById('phoneContainer').classList.add('hidden');
+ 1994             document.getElementById('sequenceContainer').classList.add('hidden');
+ 1995             document.getElementById('passwordContainer').classList.add('hidden');
+ 1996             document.getElementById('textinputContainer').classList.add('hidden');
+ 1997 
+ 1998             const introFlow = document.getElementById('introFlow');
+ 1999             introFlow.classList.remove('hidden');
+ 2000 
+ 2001             document.getElementById('envelopeMessage').textContent = envelopeText;
+ 2002 
+ 2003             document.querySelectorAll('.intro-step').forEach(step => {
+ 2004                 step.classList.remove('active');
+ 2005             });
+ 2006             document.getElementById('step4').classList.add('active');
+ 2007 
+ 2008             currentNumber = '';
+ 2009             updateDisplay();
+ 2010         }
+ 2011 
+ 2012         // ========== SEQUENCE GAME LOGIC ==========
+ 2013         let sequenceOrder = [];
+ 2014         let draggedItem = null;
+ 2015         let draggedIndex = null;
+ 2016 
+ 2017         function initSequenceGame() {
+ 2018             const config = LEVEL_CONFIG[currentLevel];
+ 2019             sequenceOrder = [...config.initialOrder];
+ 2020             renderSequence();
+ 2021 
+ 2022             document.getElementById('sequenceStatus').classList.remove('show');
+ 2023             document.getElementById('sequenceSuccessOverlay').classList.remove('show');
+ 2024         }
+ 2025 
+ 2026         function renderSequence() {
+ 2027             const container = document.getElementById('sequenceSlots');
+ 2028             container.innerHTML = '';
+ 2029 
+ 2030             sequenceOrder.forEach((num, index) => {
+ 2031                 const item = document.createElement('div');
+ 2032                 item.className = 'sequence-item';
+ 2033                 item.textContent = num;
+ 2034                 item.dataset.index = index;
+ 2035                 item.draggable = true;
+ 2036 
+ 2037                 // Desktop drag events
+ 2038                 item.addEventListener('dragstart', handleDragStart);
+ 2039                 item.addEventListener('dragend', handleDragEnd);
+ 2040                 item.addEventListener('dragover', handleDragOver);
+ 2041                 item.addEventListener('dragenter', handleDragEnter);
+ 2042                 item.addEventListener('dragleave', handleDragLeave);
+ 2043                 item.addEventListener('drop', handleDrop);
+ 2044 
+ 2045                 // Touch events for mobile
+ 2046                 item.addEventListener('touchstart', handleTouchStart, { passive: false });
+ 2047                 item.addEventListener('touchmove', handleTouchMove, { passive: false });
+ 2048                 item.addEventListener('touchend', handleTouchEnd);
+ 2049 
+ 2050                 container.appendChild(item);
+ 2051             });
+ 2052         }
+ 2053 
+ 2054         function handleDragStart(e) {
+ 2055             draggedItem = this;
+ 2056             draggedIndex = parseInt(this.dataset.index);
+ 2057             this.classList.add('dragging');
+ 2058             e.dataTransfer.effectAllowed = 'move';
+ 2059             e.dataTransfer.setData('text/plain', draggedIndex);
+ 2060         }
+ 2061 
+ 2062         function handleDragEnd() {
+ 2063             this.classList.remove('dragging');
+ 2064             document.querySelectorAll('.sequence-item').forEach(item => {
+ 2065                 item.classList.remove('drag-over');
+ 2066             });
+ 2067             draggedItem = null;
+ 2068             draggedIndex = null;
+ 2069         }
+ 2070 
+ 2071         function handleDragOver(e) {
+ 2072             e.preventDefault();
+ 2073             e.dataTransfer.dropEffect = 'move';
+ 2074         }
+ 2075 
+ 2076         function handleDragEnter(e) {
+ 2077             e.preventDefault();
+ 2078             if (this !== draggedItem) {
+ 2079                 this.classList.add('drag-over');
+ 2080             }
+ 2081         }
+ 2082 
+ 2083         function handleDragLeave() {
+ 2084             this.classList.remove('drag-over');
+ 2085         }
+ 2086 
+ 2087         function handleDrop(e) {
+ 2088             e.preventDefault();
+ 2089             this.classList.remove('drag-over');
+ 2090 
+ 2091             const targetIndex = parseInt(this.dataset.index);
+ 2092 
+ 2093             if (draggedIndex !== null && targetIndex !== draggedIndex) {
+ 2094                 // Swap the items
+ 2095                 const temp = sequenceOrder[draggedIndex];
+ 2096                 sequenceOrder[draggedIndex] = sequenceOrder[targetIndex];
+ 2097                 sequenceOrder[targetIndex] = temp;
+ 2098 
+ 2099                 renderSequence();
+ 2100                 playTone(500, 0.1);
+ 2101             }
+ 2102         }
+ 2103 
+ 2104         // Touch handling for mobile
+ 2105         let touchStartX = 0;
+ 2106         let touchStartY = 0;
+ 2107         let touchCurrentItem = null;
+ 2108         let touchClone = null;
+ 2109 
+ 2110         function handleTouchStart(e) {
+ 2111             e.preventDefault();
+ 2112             touchCurrentItem = this;
+ 2113             draggedIndex = parseInt(this.dataset.index);
+ 2114 
+ 2115             const touch = e.touches[0];
+ 2116             touchStartX = touch.clientX;
+ 2117             touchStartY = touch.clientY;
+ 2118 
+ 2119             this.classList.add('dragging');
+ 2120 
+ 2121             // Create a clone for visual feedback
+ 2122             touchClone = this.cloneNode(true);
+ 2123             touchClone.style.position = 'fixed';
+ 2124             touchClone.style.pointerEvents = 'none';
+ 2125             touchClone.style.zIndex = '1000';
+ 2126             touchClone.style.opacity = '0.8';
+ 2127             touchClone.style.transform = 'scale(1.1)';
+ 2128             const rect = this.getBoundingClientRect();
+ 2129             touchClone.style.left = rect.left + 'px';
+ 2130             touchClone.style.top = rect.top + 'px';
+ 2131             touchClone.style.width = rect.width + 'px';
+ 2132             touchClone.style.height = rect.height + 'px';
+ 2133             document.body.appendChild(touchClone);
+ 2134         }
+ 2135 
+ 2136         function handleTouchMove(e) {
+ 2137             e.preventDefault();
+ 2138             if (!touchClone) return;
+ 2139 
+ 2140             const touch = e.touches[0];
+ 2141             const rect = touchCurrentItem.getBoundingClientRect();
+ 2142 
+ 2143             touchClone.style.left = (touch.clientX - rect.width / 2) + 'px';
+ 2144             touchClone.style.top = (touch.clientY - rect.height / 2) + 'px';
+ 2145 
+ 2146             // Find element under touch
+ 2147             touchClone.style.display = 'none';
+ 2148             const elementBelow = document.elementFromPoint(touch.clientX, touch.clientY);
+ 2149             touchClone.style.display = 'flex';
+ 2150 
+ 2151             document.querySelectorAll('.sequence-item').forEach(item => {
+ 2152                 item.classList.remove('drag-over');
+ 2153             });
+ 2154 
+ 2155             if (elementBelow && elementBelow.classList.contains('sequence-item') && elementBelow !== touchCurrentItem) {
+ 2156                 elementBelow.classList.add('drag-over');
+ 2157             }
+ 2158         }
+ 2159 
+ 2160         function handleTouchEnd(e) {
+ 2161             if (!touchCurrentItem) return;
+ 2162 
+ 2163             touchCurrentItem.classList.remove('dragging');
+ 2164 
+ 2165             if (touchClone) {
+ 2166                 // Find the target element
+ 2167                 const touch = e.changedTouches[0];
+ 2168                 touchClone.style.display = 'none';
+ 2169                 const elementBelow = document.elementFromPoint(touch.clientX, touch.clientY);
+ 2170                 touchClone.remove();
+ 2171                 touchClone = null;
+ 2172 
+ 2173                 if (elementBelow && elementBelow.classList.contains('sequence-item')) {
+ 2174                     const targetIndex = parseInt(elementBelow.dataset.index);
+ 2175 
+ 2176                     if (draggedIndex !== null && targetIndex !== draggedIndex) {
+ 2177                         const temp = sequenceOrder[draggedIndex];
+ 2178                         sequenceOrder[draggedIndex] = sequenceOrder[targetIndex];
+ 2179                         sequenceOrder[targetIndex] = temp;
+ 2180 
+ 2181                         renderSequence();
+ 2182                         playTone(500, 0.1);
+ 2183                     }
+ 2184                 }
+ 2185             }
+ 2186 
+ 2187             document.querySelectorAll('.sequence-item').forEach(item => {
+ 2188                 item.classList.remove('drag-over');
+ 2189             });
+ 2190 
+ 2191             touchCurrentItem = null;
+ 2192             draggedIndex = null;
+ 2193         }
+ 2194 
+ 2195         function checkSequence() {
+ 2196             const config = LEVEL_CONFIG[currentLevel];
+ 2197             const isCorrect = sequenceOrder.every((num, index) => num === config.correctOrder[index]);
+ 2198 
+ 2199             if (isCorrect) {
+ 2200                 // Show success animation on all items
+ 2201                 document.querySelectorAll('.sequence-item').forEach(item => {
+ 2202                     item.classList.add('correct');
+ 2203                 });
+ 2204 
+ 2205                 playGeneratedSuccessSound();
+ 2206 
+ 2207                 document.getElementById('sequenceSuccessOverlay').classList.add('show');
+ 2208 
+ 2209                 setTimeout(() => {
+ 2210                     document.getElementById('sequenceSuccessOverlay').classList.remove('show');
+ 2211                     advanceToNextLevel();
+ 2212                 }, 2500);
+ 2213             } else {
+ 2214                 const status = document.getElementById('sequenceStatus');
+ 2215                 status.textContent = 'é †åºä¸æ­£ç¢ºï¼Œè«‹å†è©¦ä¸€æ¬¡ï¼(-5åˆ†é˜)';
+ 2216                 status.className = 'sequence-status show error';
+ 2217                 playGeneratedErrorSound();
+ 2218                 applyTimePenalty();
+ 2219 
+ 2220                 setTimeout(() => {
+ 2221                     status.classList.remove('show');
+ 2222                 }, 3000);
+ 2223             }
+ 2224         }
+ 2225 
+ 2226         function resetSequence() {
+ 2227             const config = LEVEL_CONFIG[currentLevel];
+ 2228             sequenceOrder = [...config.initialOrder];
+ 2229             renderSequence();
+ 2230             playTone(300, 0.1);
+ 2231 
+ 2232             document.getElementById('sequenceStatus').classList.remove('show');
+ 2233         }
+ 2234 
+ 2235         // Sequence game button listeners
+ 2236         document.getElementById('sequenceResetBtn').addEventListener('click', resetSequence);
+ 2237         document.getElementById('sequenceSubmitBtn').addEventListener('click', checkSequence);
+ 2238 
+ 2239         // ========== PASSWORD GAME LOGIC ==========
+ 2240         let passwordValue = '';
+ 2241 
+ 2242         function initPasswordGame() {
+ 2243             passwordValue = '';
+ 2244             updatePasswordDisplay();
+ 2245             document.getElementById('passwordStatus').classList.remove('show');
+ 2246             document.getElementById('passwordSuccessOverlay').classList.remove('show');
+ 2247         }
+ 2248 
+ 2249         function updatePasswordDisplay() {
+ 2250             const config = LEVEL_CONFIG[currentLevel];
+ 2251             for (let i = 0; i < config.length; i++) {
+ 2252                 const slot = document.getElementById(`pwSlot${i}`);
+ 2253                 if (i < passwordValue.length) {
+ 2254                     slot.textContent = passwordValue[i];
+ 2255                     slot.classList.add('filled');
+ 2256                     slot.classList.remove('active');
+ 2257                 } else if (i === passwordValue.length) {
+ 2258                     slot.textContent = '_';
+ 2259                     slot.classList.remove('filled');
+ 2260                     slot.classList.add('active');
+ 2261                 } else {
+ 2262                     slot.textContent = '_';
+ 2263                     slot.classList.remove('filled', 'active');
+ 2264                 }
+ 2265             }
+ 2266         }
+ 2267 
+ 2268         function addPasswordDigit(digit) {
+ 2269             const config = LEVEL_CONFIG[currentLevel];
+ 2270             if (passwordValue.length < config.length) {
+ 2271                 passwordValue += digit;
+ 2272                 updatePasswordDisplay();
+ 2273                 playTone(500 + parseInt(digit) * 50, 0.1);
+ 2274             }
+ 2275         }
+ 2276 
+ 2277         function removePasswordDigit() {
+ 2278             if (passwordValue.length > 0) {
+ 2279                 passwordValue = passwordValue.slice(0, -1);
+ 2280                 updatePasswordDisplay();
+ 2281                 playTone(300, 0.1);
+ 2282             }
+ 2283         }
+ 2284 
+ 2285         function checkPassword() {
+ 2286             const config = LEVEL_CONFIG[currentLevel];
+ 2287             
+ 2288             if (passwordValue.length < config.length) {
+ 2289                 const status = document.getElementById('passwordStatus');
+ 2290                 status.textContent = 'è«‹è¼¸å…¥å®Œæ•´å¯†ç¢¼ï¼';
+ 2291                 status.className = 'password-status show error';
+ 2292                 playGeneratedErrorSound();
+ 2293                 setTimeout(() => {
+ 2294                     status.classList.remove('show');
+ 2295                 }, 2000);
+ 2296                 return;
+ 2297             }
+ 2298 
+ 2299             if (passwordValue === config.correctAnswer) {
+ 2300                 playGeneratedSuccessSound();
+ 2301                 document.getElementById('passwordSuccessOverlay').classList.add('show');
+ 2302 
+ 2303                 setTimeout(() => {
+ 2304                     document.getElementById('passwordSuccessOverlay').classList.remove('show');
+ 2305                     advanceToNextLevel();
+ 2306                 }, 2500);
+ 2307             } else {
+ 2308                 const status = document.getElementById('passwordStatus');
+ 2309                 status.textContent = 'å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹å†è©¦ä¸€æ¬¡ï¼(-5åˆ†é˜)';
+ 2310                 status.className = 'password-status show error';
+ 2311                 playGeneratedErrorSound();
+ 2312                 applyTimePenalty();
+ 2313 
+ 2314                 setTimeout(() => {
+ 2315                     status.classList.remove('show');
+ 2316                 }, 3000);
+ 2317             }
+ 2318         }
+ 2319 
+ 2320         // Password keypad listeners
+ 2321         document.querySelectorAll('.password-key').forEach(key => {
+ 2322             key.addEventListener('click', () => {
+ 2323                 const num = key.dataset.num;
+ 2324                 if (num === 'back') {
+ 2325                     removePasswordDigit();
+ 2326                 } else if (num === 'enter') {
+ 2327                     checkPassword();
+ 2328                 } else {
+ 2329                     addPasswordDigit(num);
+ 2330                 }
+ 2331             });
+ 2332         });
+ 2333 
+ 2334         document.getElementById('passwordClearBtn').addEventListener('click', () => {
+ 2335             passwordValue = '';
+ 2336             updatePasswordDisplay();
+ 2337             playTone(300, 0.1);
+ 2338         });
+ 2339 
+ 2340         document.getElementById('passwordSubmitBtn').addEventListener('click', checkPassword);
+ 2341 
+ 2342         // ========== TEXT INPUT GAME LOGIC ==========
+ 2343         let textInputValue = '';
+ 2344 
+ 2345         function initTextInputGame() {
+ 2346             textInputValue = '';
+ 2347             updateTextInputDisplay();
+ 2348             document.getElementById('textinputStatus').classList.remove('show');
+ 2349             document.getElementById('textinputSuccessOverlay').classList.remove('show');
+ 2350         }
+ 2351 
+ 2352         function updateTextInputDisplay() {
+ 2353             const config = LEVEL_CONFIG[currentLevel];
+ 2354             for (let i = 0; i < config.length; i++) {
+ 2355                 const slot = document.getElementById(`tiSlot${i}`);
+ 2356                 if (i < textInputValue.length) {
+ 2357                     slot.textContent = textInputValue[i].toUpperCase();
+ 2358                     slot.classList.add('filled');
+ 2359                     slot.classList.remove('active');
+ 2360                 } else if (i === textInputValue.length) {
+ 2361                     slot.textContent = '_';
+ 2362                     slot.classList.remove('filled');
+ 2363                     slot.classList.add('active');
+ 2364                 } else {
+ 2365                     slot.textContent = '_';
+ 2366                     slot.classList.remove('filled', 'active');
+ 2367                 }
+ 2368             }
+ 2369         }
+ 2370 
+ 2371         function addTextInputChar(char) {
+ 2372             const config = LEVEL_CONFIG[currentLevel];
+ 2373             if (textInputValue.length < config.length) {
+ 2374                 textInputValue += char.toUpperCase();
+ 2375                 updateTextInputDisplay();
+ 2376                 playTone(600, 0.1);
+ 2377             }
+ 2378         }
+ 2379 
+ 2380         function removeTextInputChar() {
+ 2381             if (textInputValue.length > 0) {
+ 2382                 textInputValue = textInputValue.slice(0, -1);
+ 2383                 updateTextInputDisplay();
+ 2384                 playTone(300, 0.1);
+ 2385             }
+ 2386         }
+ 2387 
+ 2388         function checkTextInput() {
+ 2389             const config = LEVEL_CONFIG[currentLevel];
+ 2390             
+ 2391             if (textInputValue.length < config.length) {
+ 2392                 const status = document.getElementById('textinputStatus');
+ 2393                 status.textContent = 'è«‹è¼¸å…¥å®Œæ•´ä»£ç¢¼ï¼';
+ 2394                 status.className = 'textinput-status show error';
+ 2395                 playGeneratedErrorSound();
+ 2396                 setTimeout(() => {
+ 2397                     status.classList.remove('show');
+ 2398                 }, 2000);
+ 2399                 return;
+ 2400             }
+ 2401 
+ 2402             if (textInputValue.toUpperCase() === config.correctAnswer.toUpperCase()) {
+ 2403                 playGeneratedSuccessSound();
+ 2404                 document.getElementById('textinputSuccessOverlay').classList.add('show');
+ 2405 
+ 2406                 setTimeout(() => {
+ 2407                     document.getElementById('textinputSuccessOverlay').classList.remove('show');
+ 2408                     advanceToNextLevel();
+ 2409                 }, 2500);
+ 2410             } else {
+ 2411                 const status = document.getElementById('textinputStatus');
+ 2412                 status.textContent = 'ä»£ç¢¼éŒ¯èª¤ï¼Œè«‹å†è©¦ä¸€æ¬¡ï¼(-5åˆ†é˜)';
+ 2413                 status.className = 'textinput-status show error';
+ 2414                 playGeneratedErrorSound();
+ 2415                 applyTimePenalty();
+ 2416 
+ 2417                 setTimeout(() => {
+ 2418                     status.classList.remove('show');
+ 2419                 }, 3000);
+ 2420             }
+ 2421         }
+ 2422 
+ 2423         // Text input keyboard listeners
+ 2424         document.querySelectorAll('.textinput-key').forEach(key => {
+ 2425             key.addEventListener('click', () => {
+ 2426                 const char = key.dataset.char;
+ 2427                 if (char === 'back') {
+ 2428                     removeTextInputChar();
+ 2429                 } else {
+ 2430                     addTextInputChar(char);
+ 2431                 }
+ 2432             });
+ 2433         });
+ 2434 
+ 2435         document.getElementById('textinputClearBtn').addEventListener('click', () => {
+ 2436             textInputValue = '';
+ 2437             updateTextInputDisplay();
+ 2438             playTone(300, 0.1);
+ 2439         });
+ 2440 
+ 2441         document.getElementById('textinputSubmitBtn').addEventListener('click', checkTextInput);
+ 2442 
+ 2443         // ========== INTRO FLOW LOGIC ==========
+ 2444 
+ 2445         let currentStep = 1;
+ 2446         let audioContext = null;
+ 2447         let ambientSoundsPlaying = false;
+ 2448 
+ 2449         function getAudioContext() {
+ 2450             if (!audioContext) {
+ 2451                 try {
+ 2452                     audioContext = new (window.AudioContext || window.webkitAudioContext)();
+ 2453                     if (audioContext.state === 'suspended') {
+ 2454                         audioContext.resume();
+ 2455                     }
+ 2456                 } catch (error) {
+ 2457                     console.error('AudioContext creation failed:', error);
+ 2458                     return null;
+ 2459                 }
+ 2460             }
+ 2461             return audioContext;
+ 2462         }
+ 2463 
+ 2464         function goToStep(stepNum) {
+ 2465             document.querySelectorAll('.intro-step').forEach(step => {
+ 2466                 step.classList.remove('active');
+ 2467             });
+ 2468 
+ 2469             const targetStep = document.getElementById(`step${stepNum}`);
+ 2470             if (targetStep) {
+ 2471                 targetStep.classList.add('active');
+ 2472                 currentStep = stepNum;
+ 2473             }
+ 2474         }
+ 2475 
+ 2476         function playCarSound() {
+ 2477             const ctx = getAudioContext();
+ 2478             if (!ctx) return;
+ 2479 
+ 2480             try {
+ 2481                 const oscillator = ctx.createOscillator();
+ 2482                 const gainNode = ctx.createGain();
+ 2483                 const filter = ctx.createBiquadFilter();
+ 2484 
+ 2485                 oscillator.connect(filter);
+ 2486                 filter.connect(gainNode);
+ 2487                 gainNode.connect(ctx.destination);
+ 2488 
+ 2489                 oscillator.type = 'sawtooth';
+ 2490                 oscillator.frequency.value = 80;
+ 2491 
+ 2492                 oscillator.frequency.setValueAtTime(80, ctx.currentTime);
+ 2493                 oscillator.frequency.linearRampToValueAtTime(120, ctx.currentTime + 2);
+ 2494                 oscillator.frequency.linearRampToValueAtTime(90, ctx.currentTime + 4);
+ 2495 
+ 2496                 filter.type = 'lowpass';
+ 2497                 filter.frequency.value = 200;
+ 2498 
+ 2499                 gainNode.gain.value = 0.15;
+ 2500 
+ 2501                 oscillator.start(ctx.currentTime);
+ 2502                 oscillator.stop(ctx.currentTime + 5);
+ 2503             } catch (error) {
+ 2504                 console.error('Error playing car sound:', error);
+ 2505             }
+ 2506         }
+ 2507 
+ 2508         function playTrafficLightSound() {
+ 2509             const ctx = getAudioContext();
+ 2510             if (!ctx) return;
+ 2511 
+ 2512             try {
+ 2513                 const beepTimes = [0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5];
+ 2514 
+ 2515                 beepTimes.forEach(time => {
+ 2516                     const oscillator = ctx.createOscillator();
+ 2517                     const gainNode = ctx.createGain();
+ 2518 
+ 2519                     oscillator.connect(gainNode);
+ 2520                     gainNode.connect(ctx.destination);
+ 2521 
+ 2522                     oscillator.frequency.value = 800;
+ 2523                     oscillator.type = 'sine';
+ 2524 
+ 2525                     gainNode.gain.setValueAtTime(0, ctx.currentTime + time);
+ 2526                     gainNode.gain.linearRampToValueAtTime(0.2, ctx.currentTime + time + 0.05);
+ 2527                     gainNode.gain.linearRampToValueAtTime(0, ctx.currentTime + time + 0.2);
+ 2528 
+ 2529                     oscillator.start(ctx.currentTime + time);
+ 2530                     oscillator.stop(ctx.currentTime + time + 0.2);
+ 2531                 });
+ 2532             } catch (error) {
+ 2533                 console.error('Error playing traffic light sound:', error);
+ 2534             }
+ 2535         }
+ 2536 
+ 2537         function playAmbientSounds() {
+ 2538             if (ambientSoundsPlaying) return;
+ 2539 
+ 2540             const ctx = getAudioContext();
+ 2541             if (!ctx) {
+ 2542                 console.error('AudioContext not available');
+ 2543                 return;
+ 2544             }
+ 2545 
+ 2546             if (ctx.state === 'suspended') {
+ 2547                 ctx.resume().then(() => {
+ 2548                     ambientSoundsPlaying = true;
+ 2549                     playCarSound();
+ 2550                     playTrafficLightSound();
+ 2551                 }).catch(err => {
+ 2552                     console.error('Failed to resume AudioContext:', err);
+ 2553                 });
+ 2554             } else {
+ 2555                 ambientSoundsPlaying = true;
+ 2556                 playCarSound();
+ 2557                 playTrafficLightSound();
+ 2558             }
+ 2559 
+ 2560             setTimeout(() => {
+ 2561                 ambientSoundsPlaying = false;
+ 2562             }, 5000);
+ 2563         }
+ 2564 
+ 2565         function playBossAudio() {
+ 2566             const audio = new Audio('è€é—†é–‹å ´ç™½.m4a');
+ 2567 
+ 2568             audio.addEventListener('loadedmetadata', () => {
+ 2569                 console.log('Boss audio loaded successfully');
+ 2570             });
+ 2571 
+ 2572             audio.addEventListener('ended', () => {
+ 2573                 document.getElementById('nextBtn2').classList.remove('hidden');
+ 2574                 document.getElementById('bossAudioIndicator').textContent = 'æ’­æ”¾å®Œç•¢';
+ 2575             });
+ 2576 
+ 2577             audio.addEventListener('error', () => {
+ 2578                 document.getElementById('nextBtn2').classList.remove('hidden');
+ 2579                 document.getElementById('bossAudioIndicator').textContent = 'âš ï¸ éŸ³é »æ–‡ä»¶æœªæ‰¾åˆ°ï¼Œè«‹ç¹¼çºŒ';
+ 2580             });
+ 2581 
+ 2582             audio.play().catch(() => {
+ 2583                 document.getElementById('nextBtn2').classList.remove('hidden');
+ 2584                 document.getElementById('bossAudioIndicator').textContent = 'âš ï¸ ç„¡æ³•æ’­æ”¾éŸ³é »ï¼Œè«‹ç¹¼çºŒ';
+ 2585             });
+ 2586         }
+ 2587 
+ 2588         document.getElementById('startBtn').addEventListener('click', () => {
+ 2589             const ctx = getAudioContext();
+ 2590             if (ctx && ctx.state === 'suspended') {
+ 2591                 ctx.resume();
+ 2592             }
+ 2593 
+ 2594             startTimer();
+ 2595 
+ 2596             goToStep(2);
+ 2597             setTimeout(() => {
+ 2598                 playAmbientSounds();
+ 2599             }, 300);
+ 2600         });
+ 2601 
+ 2602         document.getElementById('nextBtn1').addEventListener('click', () => {
+ 2603             goToStep(3);
+ 2604             setTimeout(() => {
+ 2605                 playBossAudio();
+ 2606             }, 500);
+ 2607         });
+ 2608 
+ 2609         document.getElementById('nextBtn2').addEventListener('click', () => {
+ 2610             goToStep(4);
+ 2611         });
+ 2612 
+ 2613         document.getElementById('continueToPhoneBtn').addEventListener('click', () => {
+ 2614             showGameForLevel(currentLevel);
+ 2615         });
+ 2616 
+ 2617         // ========== PHONE CONFIGURATION ==========
+ 2618 
+ 2619         const MAX_DIGITS = 8;
+ 2620 
+ 2621         // ========== PHONE LOGIC ==========
+ 2622 
+ 2623         let currentNumber = '';
+ 2624         const display = document.getElementById('display');
+ 2625         const statusMessage = document.getElementById('statusMessage');
+ 2626         const successOverlay = document.getElementById('successOverlay');
+ 2627         const clearBtn = document.getElementById('clearBtn');
+ 2628         const callBtn = document.getElementById('callBtn');
+ 2629 
+ 2630         function playTone(frequency, duration) {
+ 2631             const ctx = getAudioContext();
+ 2632             if (!ctx) return;
+ 2633 
+ 2634             try {
+ 2635                 const oscillator = ctx.createOscillator();
+ 2636                 const gainNode = ctx.createGain();
+ 2637 
+ 2638                 oscillator.connect(gainNode);
+ 2639                 gainNode.connect(ctx.destination);
+ 2640 
+ 2641                 oscillator.frequency.value = frequency;
+ 2642                 oscillator.type = 'sine';
+ 2643 
+ 2644                 gainNode.gain.setValueAtTime(0.3, ctx.currentTime);
+ 2645                 gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + duration);
+ 2646 
+ 2647                 oscillator.start(ctx.currentTime);
+ 2648                 oscillator.stop(ctx.currentTime + duration);
+ 2649             } catch (error) {
+ 2650                 console.error('Error playing tone:', error);
+ 2651             }
+ 2652         }
+ 2653 
+ 2654         function playSuccessSound(audioFile = null) {
+ 2655             if (audioFile) {
+ 2656                 const audio = new Audio(audioFile);
+ 2657                 audio.play().catch(() => {
+ 2658                     playGeneratedSuccessSound();
+ 2659                 });
+ 2660             } else {
+ 2661                 playGeneratedSuccessSound();
+ 2662             }
+ 2663         }
+ 2664 
+ 2665         function playGeneratedSuccessSound() {
+ 2666             const melody = [
+ 2667                 { freq: 523.25, time: 0 },
+ 2668                 { freq: 659.25, time: 0.15 },
+ 2669                 { freq: 783.99, time: 0.3 },
+ 2670                 { freq: 1046.50, time: 0.45 }
+ 2671             ];
+ 2672 
+ 2673             melody.forEach(note => {
+ 2674                 setTimeout(() => playTone(note.freq, 0.2), note.time * 1000);
+ 2675             });
+ 2676 
+ 2677             setTimeout(() => {
+ 2678                 playTone(523.25, 0.5);
+ 2679                 playTone(659.25, 0.5);
+ 2680                 playTone(783.99, 0.5);
+ 2681             }, 600);
+ 2682         }
+ 2683 
+ 2684         function playErrorSound(audioFile = null) {
+ 2685             if (audioFile) {
+ 2686                 const audio = new Audio(audioFile);
+ 2687                 audio.play().catch(() => {
+ 2688                     playGeneratedErrorSound();
+ 2689                 });
+ 2690             } else {
+ 2691                 playGeneratedErrorSound();
+ 2692             }
+ 2693         }
+ 2694 
+ 2695         function playGeneratedErrorSound() {
+ 2696             playTone(200, 0.1);
+ 2697             setTimeout(() => playTone(150, 0.2), 100);
+ 2698         }
+ 2699 
+ 2700         function playKeyTone(num) {
+ 2701             const frequencies = {
+ 2702                 '1': 697, '2': 697, '3': 697,
+ 2703                 '4': 770, '5': 770, '6': 770,
+ 2704                 '7': 852, '8': 852, '9': 852,
+ 2705                 '*': 941, '0': 941, '#': 941
+ 2706             };
+ 2707             playTone(frequencies[num] || 400, 0.1);
+ 2708         }
+ 2709 
+ 2710         function updateDisplay() {
+ 2711             if (currentNumber === '') {
+ 2712                 display.textContent = 'Enter Number';
+ 2713                 display.classList.add('empty');
+ 2714             } else {
+ 2715                 display.textContent = currentNumber;
+ 2716                 display.classList.remove('empty');
+ 2717             }
+ 2718         }
+ 2719 
+ 2720         function showStatus(message, type) {
+ 2721             statusMessage.textContent = message;
+ 2722             statusMessage.className = `status-message show ${type}`;
+ 2723             setTimeout(() => {
+ 2724                 statusMessage.classList.remove('show');
+ 2725             }, 3000);
+ 2726         }
+ 2727 
+ 2728         function updateSuccessOverlay(icon, title, subtext) {
+ 2729             const iconElement = successOverlay.querySelector('.success-icon');
+ 2730             const titleElement = successOverlay.querySelector('.success-text');
+ 2731             const subtextElement = successOverlay.querySelector('.success-subtext');
+ 2732 
+ 2733             iconElement.textContent = icon;
+ 2734             titleElement.textContent = title;
+ 2735             subtextElement.textContent = subtext;
+ 2736         }
+ 2737 
+ 2738         function checkNumber() {
+ 2739             const levelConfig = LEVEL_CONFIG[currentLevel];
+ 2740             const correctAnswers = levelConfig.correctAnswers;
+ 2741             const wrongAnswers = levelConfig.wrongAnswers;
+ 2742 
+ 2743             if (correctAnswers[currentNumber]) {
+ 2744                 const answer = correctAnswers[currentNumber];
+ 2745                 updateSuccessOverlay(answer.overlayIcon, answer.overlayTitle, answer.overlaySubtext);
+ 2746                 playSuccessSound(answer.audioFile);
+ 2747                 display.parentElement.classList.add('success');
+ 2748                 successOverlay.classList.add('show');
+ 2749 
+ 2750                 setTimeout(() => {
+ 2751                     display.parentElement.classList.remove('success');
+ 2752                 }, 1000);
+ 2753 
+ 2754                 setTimeout(() => {
+ 2755                     successOverlay.classList.remove('show');
+ 2756                     advanceToNextLevel();
+ 2757                 }, 3000);
+ 2758             } else if (wrongAnswers[currentNumber]) {
+ 2759                 const wrongAnswer = wrongAnswers[currentNumber];
+ 2760                 playErrorSound(wrongAnswer.audioFile);
+ 2761                 showStatus(wrongAnswer.message + ' (-5åˆ†é˜)', 'error');
+ 2762                 applyTimePenalty();
+ 2763             } else {
+ 2764                 playErrorSound(DEFAULT_ERROR_AUDIO);
+ 2765                 showStatus(DEFAULT_ERROR_MESSAGE + ' (-5åˆ†é˜)', 'error');
+ 2766                 applyTimePenalty();
+ 2767             }
+ 2768         }
+ 2769 
+ 2770         document.querySelectorAll('.key').forEach(key => {
+ 2771             key.addEventListener('click', () => {
+ 2772                 if (currentNumber.length < MAX_DIGITS) {
+ 2773                     const num = key.dataset.num;
+ 2774                     currentNumber += num;
+ 2775                     updateDisplay();
+ 2776                     playKeyTone(num);
+ 2777                 }
+ 2778             });
+ 2779         });
+ 2780 
+ 2781         clearBtn.addEventListener('click', () => {
+ 2782             currentNumber = '';
+ 2783             updateDisplay();
+ 2784             playTone(300, 0.1);
+ 2785         });
+ 2786 
+ 2787         callBtn.addEventListener('click', () => {
+ 2788             if (currentNumber === '') {
+ 2789                 showStatus('è«‹å…ˆè¼¸å…¥è™Ÿç¢¼', 'error');
+ 2790                 playErrorSound();
+ 2791             } else {
+ 2792                 checkNumber();
+ 2793             }
+ 2794         });
+ 2795 
+ 2796         document.addEventListener('keydown', (e) => {
+ 2797             if (!document.getElementById('finalScreen').classList.contains('hidden')) {
+ 2798                 return;
+ 2799             }
+ 2800 
+ 2801             const config = LEVEL_CONFIG[currentLevel];
+ 2802 
+ 2803             // Handle password game keyboard input
+ 2804             if (config?.type === 'password' && !document.getElementById('passwordContainer').classList.contains('hidden')) {
+ 2805                 if (e.key >= '0' && e.key <= '9') {
+ 2806                     addPasswordDigit(e.key);
+ 2807                 } else if (e.key === 'Backspace') {
+ 2808                     removePasswordDigit();
+ 2809                 } else if (e.key === 'Enter') {
+ 2810                     checkPassword();
+ 2811                 } else if (e.key === 'Escape') {
+ 2812                     passwordValue = '';
+ 2813                     updatePasswordDisplay();
+ 2814                 }
+ 2815                 return;
+ 2816             }
+ 2817 
+ 2818             // Handle text input game keyboard input
+ 2819             if (config?.type === 'textinput' && !document.getElementById('textinputContainer').classList.contains('hidden')) {
+ 2820                 if (/^[a-zA-Z0-9]$/.test(e.key)) {
+ 2821                     addTextInputChar(e.key.toUpperCase());
+ 2822                 } else if (e.key === 'Backspace') {
+ 2823                     removeTextInputChar();
+ 2824                 } else if (e.key === 'Enter') {
+ 2825                     checkTextInput();
+ 2826                 } else if (e.key === 'Escape') {
+ 2827                     textInputValue = '';
+ 2828                     updateTextInputDisplay();
+ 2829                 }
+ 2830                 return;
+ 2831             }
+ 2832 
+ 2833             // Handle phone game keyboard input
+ 2834             if (config?.type !== 'phone') {
+ 2835                 return;
+ 2836             }
+ 2837 
+ 2838             if (document.getElementById('phoneContainer').classList.contains('hidden')) {
+ 2839                 return;
+ 2840             }
+ 2841 
+ 2842             if (e.key >= '0' && e.key <= '9') {
+ 2843                 if (currentNumber.length < MAX_DIGITS) {
+ 2844                     currentNumber += e.key;
+ 2845                     updateDisplay();
+ 2846                     playKeyTone(e.key);
+ 2847                 }
+ 2848             } else if (e.key === '*' || e.key === '#') {
+ 2849                 if (currentNumber.length < MAX_DIGITS) {
+ 2850                     currentNumber += e.key;
+ 2851                     updateDisplay();
+ 2852                     playKeyTone(e.key);
+ 2853                 }
+ 2854             } else if (e.key === 'Backspace') {
+ 2855                 currentNumber = currentNumber.slice(0, -1);
+ 2856                 updateDisplay();
+ 2857                 playTone(300, 0.1);
+ 2858             } else if (e.key === 'Enter') {
+ 2859                 if (currentNumber !== '') {
+ 2860                     checkNumber();
+ 2861                 }
+ 2862             } else if (e.key === 'Escape') {
+ 2863                 currentNumber = '';
+ 2864                 updateDisplay();
+ 2865             }
+ 2866         });
+ 2867     </script>
+ 2868 </body>
+ 2869 </html>
